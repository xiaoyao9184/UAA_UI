"use strict";angular.module("uaaUIApp",["ngResource","ngCookies","ngAria","ngCacheBuster","ngFileUpload","ngPostMessage","ngSanitize","ui.bootstrap","ui.router","ui.select","infinite-scroll","LocalStorageModule","angular-loading-bar","angular-clipboard","angularMoment","file"]).run(["$rootScope","$location","$window","$http","$state","$interval","ENV","VERSION","STATHAT","moment","AlertService",function(i,s,l,e,t,u,n,r,c,d,p){i.ENV=n,i.VERSION=r,i.icu=null,_StatHat.push(["_trackValue",c.bootstrap,1]),i.$on("$stateChangeStart",function(e,t,n,r,a){i.toState=t,i.toStateParams=n;var o=s.hash();o&&(n["#"]=o),null===i.icu&&480===d().utcOffset()&&(0===d().day()||6===d().day()||d().hour()<9||21<d().hour())&&(i.icu=u(function(){p.error("<strong>UI: </strong>Are you in ICU?")},5e3),_StatHat.push(["_trackValue",c.icu,1]))}),i.$on("$stateChangeSuccess",function(e,t,n,r,a){var o="UaaUI";(angular.isUndefined(t.data)||angular.isUndefined(t.data.previous)||!0===t.data.previous)&&(i.previousStateName=r.name,i.previousStateParams=a),angular.isDefined(t.data)&&t.data.pageTitle&&(o=t.data.pageTitle),l.document.title=o}),i.back=function(){"activate"===i.previousStateName||null===t.get(i.previousStateName)?t.go("home"):t.go(i.previousStateName,i.previousStateParams)}}]).config(["$stateProvider","$urlRouterProvider","$httpProvider","$locationProvider","httpRequestInterceptorCacheBusterProvider","AlertServiceProvider",function(e,t,n,r,a,o){a.setMatchlist([/.*api.*/,/.*protected.*/],!0),t.otherwise("/"),t.rule(function(e,t){var n=t.path(),r=n.toLowerCase();if(n!==r)return r}),e.state("site",{abstract:!0,views:{"navbar@":{templateUrl:"scripts/components/navbar/navbar.html",controller:"NavbarController"}}}),n.interceptors.push("errorHandlerInterceptor"),n.interceptors.push("zoneInterceptor"),n.interceptors.push("authExpiredInterceptor"),n.interceptors.push("authInterceptor")}]).config(["$urlMatcherFactoryProvider",function(e){e.type("boolean",{name:"boolean",decode:function(e){return 1==e||"true"==e},encode:function(e){return e?1:0},equals:function(e,t){return this.is(e)&&e===t},is:function(e){return 0<=[!0,!1,0,1].indexOf(e)},pattern:/bool|true|0|1/})}]),angular.module("uaaUIApp").constant("ENV","prod").constant("VERSION","0.0.1-SNAPSHOT").constant("STATHAT",{bootstrap:"a0eJrxQFBovvwhgPrifi1CBDUmV4",icu:"uryhasBFrhZI6QS9KxRRsSBMaEtD"}).constant("GROUPS",["zones.read","zones.write","idps.read","idps.write","clients.admin","clients.write","clients.read","clients.secret","scim.write","scim.read","scim.create","scim.userids","scim.zones","scim.invite","password.write","oauth.approval","oauth.login","approvals.me","openid","groups.update","uaa.user","uaa.resource","uaa.admin"]).constant("GRANTS",[{name:"client_credentials",type:"oauth2",token:!0,grant:!0},{name:"implicit",type:"oauth2",token:!0,grant:!0},{name:"password",type:"oauth2",token:!0,grant:!0},{name:"authorization_code",type:"oauth2",token:!0,grant:!0},{name:"auto_login",type:"oauth2",token:!0,grant:!1},{name:"passcode",type:"oauth2",token:!0,grant:!1},{name:"refresh_token",type:"flag",grant:!0},{name:"user_token",type:"other",grant:!0},{name:"saml2-bearer",type:"other",value:"urn:ietf:params:oauth:grant-type:saml2-bearer",grant:!0},{name:"jwt-bearer",type:"other",value:"urn:ietf:params:oauth:grant-type:jwt-bearer",grant:!0}]).constant("ZONE_SCOPES",[{template:"zones.<zone id>.admin",description:"scope that permits operations in a designated zone by authenticating against the default zone, such as create identity providers or clients in another zone (used together with the X-Identity-Zone-Id header)"},{template:"zones.<zone id>.read",description:"scope that permits reading the given identity zone (used together with the X-Identity-Zone-Id header)"},{template:"zones.<zone id>.clients.admin",description:"translates into clients.admin after zone switch is complete (used together with the X-Identity-Zone-Id header)"},{template:"zones.<zone id>.clients.read",description:"translates into clients.read after zone switch is complete (used together with the X-Identity-Zone-Id header)"},{template:"zones.<zone id>.clients.write",description:"translates into clients.write after zone switch is complete (used together with the X-Identity-Zone-Id header)"},{template:"zones.<zone id>.scim.read",description:"translates into scim.read after zone switch is complete (used together with the X-Identity-Zone-Id header)"},{template:"zones.<zone id>.scim.create",description:"translates into scim.create after zone switch is complete (used together with the X-Identity-Zone-Id header)"},{template:"zones.<zone id>.scim.write",description:"translates into scim.write after zone switch is complete (used together with the X-Identity-Zone-Id header)"},{template:"zones.<zone id>.scim.invite",description:"translates into scim.invite after zone switch is complete (used together with the X-Identity-Zone-Id header)"},{template:"zones.<zone id>.idps.read",description:"translates into idps.read after zone switch is complete (used together with the X-Identity-Zone-Id header)"},{template:"zones.<zone id>.idps.write",description:"translates into idps.write after zone switch is complete (used together with the X-Identity-Zone-Id header)"},{template:"zones.<zone id>.sps.read",description:"translates into sps.read after zone switch is complete (used together with the X-Identity-Zone-Id header)"},{template:"zones.<zone id>.sps.write",description:"translates into sps.write after zone switch is complete (used together with the X-Identity-Zone-Id header)"}]).constant("RESOURCE_IDS",["zones","idps","clients","scim","password","oauth","approvals","groups","uaa"]).constant("HTTP_METHIDS",["GET","HEAD","POST","PUT","PATCH","DELETE","OPTIONS","TRACE"]).constant("HTTP_HEADERS",["Accept","Accept-Charset","Accept-Encoding","Accept-Language","Accept-Ranges","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Age","Allow","Authorization","Cache-Control","Connection","Content-Encoding","Content-Disposition","Content-Language","Content-Length","Content-Location","Content-Range","Content-Type","Cookie","Date","ETag","Expect","Expires","From","Host","If-Match","If-Modified-Since","If-None-Match","If-Range","If-Unmodified-Since","Last-Modified","Link","Location","Max-Forwards","Origin","Pragma","Proxy-Authenticate","Proxy-Authorization","Range","Referer","Retry-After","Server","Set-Cookie","Set-Cookie2","TE","Trailer","Transfer-Encoding","Upgrade","User-Agent","Vary","Via","Warning","WWW-Authenticate"]).constant("SETTING",{version:8,debug:!1,url:"http://localhost:8080/uaa/",clientId:"uaa_ui",username:"admin",loginType:"password",authUrlPath:"oauth/authorize",authRedirectUrl:"#/auth_redirect?",authWindowType:"popup",authWindowParam:"toolbar=no,scrollbars=no,resizable=no,top=100,left=500,width=600,height=800",sessionCheckUrl:"session_management"}),angular.module("uaaUIApp").factory("Setting",["localStorageService","SETTING",function(t,n){return{version:7,set:function(e){t.set("setting",e)},get:function(){var e=t.get("setting");return(null===e||e.version<this.version)&&(e=angular.merge({},n),t.set("setting",e)),e}}}]),angular.module("uaaUIApp").factory("Principal",["$q","$filter","UserInfo",function(n,t,r){var a,o,i,s=!1,l=!1,u={isIdentityResolved:function(){return angular.isDefined(a)},isAuthenticated:function(){return s},isUAALogin:function(){return l},isClient:function(){return angular.isDefined(o)&&"client_credentials"===o.grant_type},isRedirect:function(){return angular.isDefined(o)&&("authorization_code"===o.grant_type||"implicit"===o.grant_type)},isSwitchingZone:function(){return!(!o||!i)&&(o.zid!==i.id&&u.canSwitchingZone(i.id))},canSwitchingZone:function(e){return!(!s||!o)&&("uaa"!==e&&0<t("filter")(o.scope,"zones."+e+".").length)},userName:function(){return u.identity().then(function(e){return null==e?"UNKNOW":e.user_name},function(e){return"UNKNOW"})},hasScope:function(e){return!(!s||!o)&&(u.isSwitchingZone()&&(e="zones."+o.zid+"."+e),o.scope.indexOf(e))},hasAnyScope:function(e){if(!s||!o)return!1;u.isSwitchingZone()&&(e="zones."+o.zid+"."+e);for(var t=0;t<e.length;t++)if(-1!==o.scope.indexOf(e[t]))return!0;return!1},hasAuthority:function(e){return!(!s||!o)&&(u.isSwitchingZone()&&(e="zones."+o.zid+"."+e),o.aud.indexOf(e))},hasAnyAuthority:function(e){if(!s||!o)return!1;u.isSwitchingZone()&&(e="zones."+o.zid+"."+e);for(var t=0;t<e.length;t++)if(-1!==o.aud.indexOf(e[t]))return!0;return!1},uaaLogin:function(e){l=e},token:function(e){return o=e,u.isRedirect()&&(l=!0),u.isClient()?u.authenticate({user_name:e.client_id}):u.userName(),u},zone:function(e){return i=e,u},authenticate:function(e){s=void 0!==(a=e)},identity:function(e){var t=n.defer();return!0===e&&(a=void 0),angular.isDefined(a)?t.resolve(a):r.get().$promise.then(function(e){if(angular.isUndefined(e.user_name))return a=void 0,s=!1,void t.reject(null);a=e,s=!0,t.resolve(a)}).catch(function(){a=void 0,s=!1,t.reject(null)}),t.promise}};return u}]),angular.module("uaaUIApp").factory("TokenHolder",["localStorageService","$window",function(r,i){return{set:function(e){var t=e.access_token?e.access_token:null;if(t){console.log("JWT:",t);var n=new Date;n.setSeconds(n.getSeconds()+e.expires_in),e.expires_at=n.getTime(),r.set("token",e)}},get:function(){return r.get("token")},remove:function(){return r.remove("token")},parseJwt:function(e){var t=e.split(".")[1].replace("-","+").replace("_","/");return angular.fromJson(i.atob(t))},hasValidToken:function(){var e=this.get();return e&&e.expires_at&&e.expires_at>(new Date).getTime()},getJwt:function(){var e=this.get();if(null===e)return{header:void 0,payload:void 0,signature:void 0};var t=e.access_token.split("."),n=t[0].replace(/-/g,"+").replace(/_/g,"/"),r=t[1].replace(/-/g,"+").replace(/_/g,"/"),a=t[2].replace(/-/g,"+").replace(/_/g,"/");n=angular.fromJson(i.atob(n));var o=i.atob(r);return o=decodeURIComponent(escape(o)),{header:n,payload:r=angular.fromJson(o),signature:a=i.atob(a)}},isSupportRefresh:function(){var e=r.get("token");return null!==e&&angular.isDefined(e.refresh_token)}}}]),angular.module("uaaUIApp").factory("ZoneHolder",["Zone","localStorageService","$q",function(n,r,a){var o,i=!0;function e(){var t=a.defer();return null===o?s("uaa").then(function(e){t.resolve(e)}):t.resolve(o),t.promise}function s(e){if(null===o||o.id!==e)return n.get({id:e}).$promise.then(function(e){return r.set("zone",e),i="uaa"===e.id,o=e});var t=a.defer();return t.resolve(o),t.promise}return o=r.get("zone"),i=null===o||"uaa"===o.id,{isUAA:function(){return i},current:e,name:function(){var t=a.defer();return e().then(function(e){t.resolve(e.name)}),t.promise},change:s,reset:function(){r.remove("zone"),i=!0,o=null}}}]),angular.module("uaaUIApp").factory("Search",["$filter","GuessSearch",function(f,h){var v,y,I,U,A=function(e){return"After "+e.moment.fromNow()},$=function(e){return"Before "+e.moment.fromNow()},w=function(e){return e.moment.toISOString()},S=function(e){return e.text},M=function(e){return e};return{init:function(e,t,n,r){v=e,y=t,U=f("filter")(n,{any:!0},!0);var a=f("filter")(n,{moment:"!!"}),o=f("filter")(n,{url:!0},!0),i=f("filter")(n,{email:!0},!0),s=f("filter")(n,function(e,t,n){return angular.isArray(e.enum)},!0),l=f("filter")(n,{sort:!0},!0),u=[];if(u.push({support:"string",data:{group:"Search",icon:"glyphicon-search",name:function(e){return"ANY:"+e},field:"ANY",operator:"co",value:function(e){return e}}}),0<a.length){var c=[];angular.forEach(a,function(e){var t={group:e.name,icon:"glyphicon-time",name:A,tags:S,field:e.field,operator:"ge",value:w};c.push(t);var n={group:e.name,icon:"glyphicon-time",name:$,tags:S,field:e.field,operator:"le",value:w};c.push(n),angular.isDefined(e.value)&&(t.value=e.value,n.value=e.value)}),u.push({support:"moment",data:c})}if(0<o.length){var d=[];angular.forEach(o,function(e){var t={group:e.name,icon:"glyphicon-retweet",name:M,tags:M,field:e.field,operator:"ge",value:M};d.push(t)}),u.push({support:"url",data:d})}if(0<i.length){var p=[];angular.forEach(i,function(e){var t={group:e.name,icon:"glyphicon-envelope",name:M,tags:M,field:e.field,operator:"co",value:M};p.push(t)}),u.push({support:"email",data:p})}if(0<s.length){var g=[];angular.forEach(s,function(e){var n={group:e.name,field:e.field};angular.forEach(e.enum,function(e){var t=angular.merge({},n,e);g.push(t)})}),u.push({support:!0,data:g})}if(angular.isDefined(r)&&u.concat(r),0<l.length){var m=[];angular.forEach(l,function(e){var t,n={group:e.name,icon:"glyphicon-sort-by-attributes",name:(t=e.name,"Sort "+t+" Asc"),field:e.field,operator:"ORDER",value:"ascending"};m.push(n);var r,a={group:e.name,icon:"glyphicon-sort-by-attributes-alt",name:(r=e.name,"Sort "+r+" Desc"),field:e.field,operator:"ORDER",value:"descending"};m.push(a)}),u.push({support:function(e,t){return!angular.isDefined(t)||0===f("filter")(t,{operator:"ORDER"},!0).length},data:m})}return u.push({support:!0,data:[{group:"Advanced",icon:"glyphicon-random",tags:"exact and",name:"EXACT",field:"EXACT",operator:"",value:"with 'AND' operator"}]}),h.config(u),I=h.guess()},tagging:function(e){var t=h.guess(e,y.value);return I.length=0,angular.merge(I,t),{group:"Search",icon:"glyphicon-search",name:"ANY:"+e,field:"ANY",operator:"co",value:e}},filtering:function(e){var t=[],a=0<f("filter")(e,{field:"EXACT"},!0).length;angular.forEach(e,function(n){var e="";if("EXACT"!==n.field&&"ORDER"!==n.operator){if("ANY"===n.field){var r=[];angular.forEach(U,function(e){var t=e.field+" co '"+n.value+"'";r.push(t)}),e=(a?"(":"")+r.join(" or ")+(a?")":"")}else e=n.field+" "+n.operator+" "+(angular.isString(n.value)?"'"+n.value+"'":n.value);t.push(e)}});var n=t.join(a?" and ":" or "),r=null,o=null,i=f("filter")(e,{operator:"ORDER"},!0);0<i.length&&(r=i[0].field,o=i[0].value),v(n,r,o),this.tagging()},refreshing:function(){this.filtering(y.value)},searching:function(e){e&&(y.value=[{group:"Search",icon:"glyphicon-search",name:"ANY:"+e,field:"ANY",operator:"co",value:e}]),this.refreshing()},usingText:M}}]),angular.module("uaaUIApp").factory("Healthz",["$resource",function(e){return e("api/healthz",{},{get:{method:"GET"}})}]),angular.module("uaaUIApp").factory("UserInfo",["$resource",function(e){return e("api/userinfo",{},{get:{method:"GET",alert:!1}})}]),angular.module("uaaUIApp").factory("Info",["$resource",function(e){return e("api/info",{},{get:{method:"GET",alert:!1}})}]),angular.module("uaaUIApp").factory("User",["$resource",function(e){return e("api/Users/:id",{},{query:{method:"GET",isArray:!1},get:{method:"GET"},save:{method:"POST"},update:{method:"PUT",headers:{"if-match":function(e){return e.data.meta.version}}},delete:{method:"DELETE"}})}]).factory("UserPassword",["$resource",function(e){return e("api/Users/:id/password",{},{change:{method:"PUT",headers:{Authorization:function(e){return angular.isUndefined(e.data.token)?null:"Bearer "+e.data.token}},transformRequest:function(e){return delete e.token,angular.toJson(e)}}})}]).factory("UserStatus",["$resource",function(e){return e("api/Users/:id/status",{},{change:{method:"PATCH"}})}]).factory("UserVerify",["$resource",function(e){return e("api/Users/:id/verify",{},{verify:{method:"GET"}})}]).factory("UserVerifyLink",["$resource",function(e){return e("api/Users/:id/verify-link",{},{verify:{method:"GET"}})}]).factory("UserMFARegistration",["$resource",function(e){return e("api/Users/:id/mfa",{},{delete:{method:"DELETE"}})}]).factory("UserInvite",["$resource",function(e){return e("api/invite_users",{},{invite:{method:"POST"}})}]),angular.module("uaaUIApp").factory("Group",["$resource",function(e){return e("api/Groups/:id",{},{query:{method:"GET",isArray:!1},get:{method:"GET",transformResponse:function(e){return e=angular.fromJson(e)}},save:{method:"POST"},update:{method:"PUT",headers:{"if-match":function(e){return e.data.meta.version}}},delete:{method:"DELETE"}})}]),angular.module("uaaUIApp").factory("Member",["$resource",function(e){return e("api/Groups/:gid/members/:id",{},{list:{method:"GET",isArray:!0},check:{method:"GET",transformResponse:function(e){return e=angular.fromJson(e)}},add:{method:"POST"},remove:{method:"DELETE"}})}]).factory("MemberType",["User","$q","$injector",function(e,a,o){var i={USER:{resourceName:"User",getName:function(e){return e.userName}},GROUP:{resourceName:"Group",getName:function(e){return e.displayName}}};return{getName:function(t){var n=a.defer(),r=i[t.type];if(!angular.isUndefined(r)){if(angular.isDefined(t.entity))n.resolve(r.getName(t.entity));else{var e=r.resourceName;o.get(e).get({id:t.value}).$promise.then(function(e){t.entity=e,n.resolve(r.getName(t.entity))}).catch(function(e){404===e.status?(t.entity=void 0,n.resolve("NOT EXIST")):(t.entity=void 0,n.resolve("UNKNOW"))})}return n.promise}}}}]),angular.module("uaaUIApp").factory("Client",["$resource",function(e){var t=function(e){return null!=e.allowedproviders&&0==e.allowedproviders.length&&delete e.allowedproviders,angular.toJson(e)};return e("api/oauth/clients/:id",{},{query:{method:"GET",isArray:!1},get:{method:"GET"},save:{method:"POST",transformRequest:t},update:{method:"PUT",transformRequest:t},delete:{method:"DELETE"}})}]).factory("ClientSecret",["$resource","Base64",function(e,t){return e("api/oauth/clients/:id/secret",{},{change:{method:"PUT",headers:{Authorization:function(e){return angular.isUndefined(e.data.token)?null:"Bearer "+e.data.token}},transformRequest:function(e){return delete e.token,angular.fromJson(e)}}})}]).factory("ClientMeta",["$resource",function(e){return e("api/oauth/clients/:id/meta",{},{query:{method:"GET",isArray:!0},get:{method:"GET",transformResponse:function(e){return e=angular.fromJson(e)}},update:{method:"PUT"}})}]),angular.module("uaaUIApp").factory("Zone",["$resource",function(e){return e("api/identity-zones/:id",{},{query:{method:"GET",isArray:!0},get:{method:"GET",transformResponse:function(e){return e=angular.fromJson(e)}},save:{method:"POST"},update:{method:"PUT"},delete:{method:"DELETE"}})}]).factory("ZoneClient",["$resource",function(e){return e("api/identity-zones/:id/clients/:cid",{},{save:{method:"POST"},delete:{method:"DELETE"}})}]),angular.module("uaaUIApp").factory("AutoLogin",["$http","Base64",function(n,r){return{code:function(e){var t="username="+encodeURIComponent(e.username)+"&password="+encodeURIComponent(e.password);return n.post("api/autologin",t,{headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json",Authorization:"Basic "+r.encode(e.clientId+":"+e.clientSecret)}})}}}]),angular.module("uaaUIApp").factory("Passcode",["$resource",function(e){return e("api/passcode",{},{get:{method:"GET"}})}]),angular.module("uaaUIApp").factory("Token",["$resource",function(e){return e("api/oauth/token/:action/:target/:id/:target2/:id2",{},{userList:{method:"GET",isArray:!0,params:{action:"list",target:"user"}},userRevoke:{method:"GET",params:{action:"revoke",target:"user"}},clientList:{method:"GET",isArray:!0,params:{action:"list",target:"client"}},clientRevoke:{method:"GET",params:{action:"revoke",target:"client"}},userClientRevoke:{method:"POST",params:{action:"revoke",target:"user",target2:"client"}},revoke:{method:"DELETE",params:{action:"revoke"}}})}]),angular.module("uaaUIApp").factory("Password",["$resource",function(e){return e("api/:action",{},{reset:{method:"POST",params:{action:"password_resets"}},change:{method:"POST",params:{action:"password_change"}}})}]),angular.module("uaaUIApp").factory("Email",["$resource",function(e){return e("api/:action",{},{verification:{method:"POST",params:{action:"email_verifications"},isArray:!1,transformResponse:function(e){return{code:e}}},change:{method:"POST",params:{action:"email_changes"}}})}]),angular.module("uaaUIApp").factory("IdentityProvider",["$resource",function(e){return e("api/identity-providers/:id",{},{query:{method:"GET",isArray:!0},get:{method:"GET",transformResponse:function(e){return e=angular.fromJson(e)}},save:{method:"POST"},update:{method:"PUT"},delete:{method:"DELETE"}})}]),angular.module("uaaUIApp").factory("MFAProvider",["$resource",function(e){return e("api/mfa-providers/:id",{},{query:{method:"GET",isArray:!0},get:{method:"GET",transformResponse:function(e){return e=angular.fromJson(e)}},save:{method:"POST"},update:{method:"PUT"},delete:{method:"DELETE"}})}]),angular.module("uaaUIApp").factory("SAMLServiceProvider",["$resource",function(e){var t=function(e){return e.config=angular.toJson(e.config),angular.toJson(e)};return e("api/saml/service-providers/:id",{},{query:{method:"GET",transformResponse:function(e){var t=angular.fromJson(e);return angular.forEach(t,function(e){e.config=angular.fromJson(e.config)}),t},isArray:!0},get:{method:"GET",transformResponse:function(e){var t=angular.fromJson(e);return t.config=angular.fromJson(t.config),t}},save:{method:"POST",transformRequest:t},update:{method:"PUT",transformRequest:t},delete:{method:"DELETE"}})}]),angular.module("uaaUIApp").factory("UAAServerProvider",["$q","Info","Healthz",function(n,r,e){var a,o=!1;return{isHealthy:function(){return o},healthz:function(){var t=n.defer();return e.get().$promise.then(function(e){o="ok\n"===e.data,t.resolve(o)}).catch(function(){o=!1,t.resolve(o)}),t.promise},info:function(e){var t=n.defer();return!0===e&&(a=void 0),angular.isDefined(a)?t.resolve(a):r.get().$promise.then(function(e){a=e,o=!0,t.resolve(a)}).catch(function(){a=null,o=!1,t.resolve(a)}),t.promise}}}]),angular.module("uaaUIApp").factory("TokenServerProvider",["$http","$window","$location","$q","Base64","Setting",function(n,u,e,c,r,d){return{refresh:function(e){var t="client_id="+encodeURIComponent(e.clientId)+"&client_secret="+encodeURIComponent(e.clientSecret)+"&grant_type=refresh_token&refresh_token="+e.token;return n.post("api/oauth/token",t,{headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json",Authorization:"Basic "+r.encode(e.clientId+":"+e.clientSecret)}})},client:function(e){return n.post("api/oauth/token","grant_type=client_credentials",{headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json",Authorization:"Basic "+r.encode(e.clientId+":"+e.clientSecret)}})},password:function(e){var t="username="+encodeURIComponent(e.username)+"&password="+encodeURIComponent(e.password)+"&grant_type=password";return n.post("api/oauth/token",t,{headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json",Authorization:"Basic "+r.encode(e.clientId+":"+e.clientSecret)}})},passcode:function(e){var t="passcode="+encodeURIComponent(e.passcode)+"&grant_type=password";return n.post("api/oauth/token",t,{headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json",Authorization:"Basic "+r.encode(e.clientId+":"+e.clientSecret)}})},authorization_code:function(e){var t="client_id="+encodeURIComponent(e.clientId)+"&redirect_uri="+encodeURIComponent(e.redirect_uri)+"&grant_type=authorization_code&code="+e.code;return n.post("api/oauth/token",t,{headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json",Authorization:"Basic "+r.encode(e.clientId+":"+e.clientSecret)}})},start_implicit:function(e,t){var n=e.response_type||"token",r="client_id="+encodeURIComponent(e.clientId)+"&redirect_uri="+encodeURIComponent(e.redirect_uri)+"&response_type="+n+"&state="+e.state,a=e.auth_url+"?"+r;if("popup"===d.get().authWindowType){var o=u.open(a,"UAA-Auth-Window",d.get().authWindowParam),i=this,s=c.defer(),l=t.$root.$on("$messageIncoming",function(e,t){var n=angular.fromJson(t);delete n.origin,i.end_data(n).then(function(e){l(),o.close(),s.resolve(e)}).catch(function(e){s.reject(e)})});return s.promise}},start_authorization_code:function(r,e){var t=r.response_type||"code",n="client_id="+encodeURIComponent(r.clientId)+"&redirect_uri="+encodeURIComponent(r.redirect_uri)+"&response_type="+t+"&state="+r.state;null===r.code||angular.isUndefined(r.code)||(n=n+"&code="+r.code);var a=r.auth_url+"?"+n;if("popup"===d.get().authWindowType){var o=u.open(a,"UAA-Auth-Window",d.get().authWindowParam),i=this,s=c.defer(),l=e.$root.$on("$messageIncoming",function(e,t){var n=angular.fromJson(t);delete n.origin,n.redirect_uri=r.redirect_uri,i.end_data(n).then(function(e){l(),o.close(),s.resolve(e)}).catch(function(e){s.reject(e)})});return s.promise}},get_redirect_data:function(e){var t={},n=new URL(location.href).searchParams,r=Array.from(n.entries());for(var a in angular.forEach(r,function(e){t[e[0]]=e[1]}),e)null===e[a]&&delete e[a];return angular.merge(t,e)},end_redirect:function(e,t,n){var r=c.defer(),a=this.get_redirect_data(n);if(null===a)r.reject({error:!0,error_description:"No redirect."});else{if(!angular.isUndefined(a.error))return r.reject(a),r.promise;"popup"===d.get().authWindowType&&null!==t.operer&&angular.isUndefined(t.operer)?(e.$emit("$messageOutgoing",angular.toJson(a)),r.reject({error:!1,error_description:"Redirect data post back to opener window. waiting for auto close."})):r.resolve(a)}return r.promise},end_data:function(e){var t=c.defer();if(null===e.code||angular.isUndefined(e.code))null===e.access_token||angular.isUndefined(e.access_token)||(e.expires_in=parseInt(e.expires_in),t.resolve(e));else{var n=d.get(),r={url:n.url,clientId:n.clientId,clientSecret:n.clientSecret,code:e.code,redirect_uri:e.redirect_uri};this.authorization_code(r).then(function(e){t.resolve(e.data)}).catch(function(e){t.resolve(e)})}return t.promise}}}]),angular.module("uaaUIApp").factory("SSOServerProvider",["$http","$window","$location","$interval","$q","Base64","Setting",function(e,u,t,c,d,n,p){return{start_logout:function(e,t){var n="client_id="+encodeURIComponent(e.clientId)+"&redirect="+encodeURIComponent(e.redirect_uri),r=e.url+"logout.do?"+n;if("popup"===p.get().authWindowType){var a=u.open(r,"UAA-Auth-Window",p.get().authWindowParam),o=d.defer(),i=t.$root.$on("$messageIncoming",function(e,t){i(),a.close(),o.resolve()});return o.promise}},start_autologin:function(e){var t="code="+encodeURIComponent(e.code)+"&client_id="+encodeURIComponent(e.clientId),n=e.url+"autologin?"+t;"popup"===p.get().authWindowType&&u.open(n,"UAA-Autologin-Window",p.get().authWindowParam)},start_passcode:function(e){var t=e.url+"passcode";"popup"===p.get().authWindowType&&u.open(t,"UAA-Passcode-Window",p.get().authWindowParam)},start_session:function(e,t){var n="clientId="+encodeURIComponent(e.clientId)+"&messageOrigin="+encodeURIComponent(e.messageOrigin),r=e.url+"?"+n,a=e.clientId+" "+e.userId,o=null;if("popup"===p.get().authWindowType){var i=u.open(r,"UAA-Session-Window",p.get().authWindowParam);o=c(function(){i.postMessage(a,r)},100);var s=d.defer(),l=t.$root.$on("$messageIncoming",function(e,t){c.cancel(o),l(),i.close(),s.resolve(t)});return s.promise}}}}]),angular.module("uaaUIApp").directive("showValidation",function(){var o=function(n,e,r,a){e.each(function(){var e=$(this),t=n.$watch(function(){return e.hasClass("ng-invalid")},function(e){a.toggleClass("has-error",e)});r.push(t)})},r=function(r,e,a){e.find(".form-group").each(function(){var e=$(this),t=e.find("input[ng-model],textarea[ng-model],select[ng-model]");if(0<t.length)o(r,t,a,e);else{var n={length:null,inputs:[]};a.push(n),n.length=r.$watch(function(){return(t=e.find("input[ng-model],textarea[ng-model],select[ng-model]")).length},function(){n.inputs.forEach(function(e){e()}),n.inputs=[],function(n,e,r){var t=e.find("div.form-inline");if(0<t.length)t.each(function(){var e=$(this),t=e.find("input[ng-model],textarea[ng-model],select[ng-model]");o(n,t,r,e)});else{var a=e.find("input[ng-model],textarea[ng-model],select[ng-model]");o(n,a,r,e)}}(r,e,n.inputs)})}})};return{restrict:"A",require:"form",link:function(e,t){var n=[];0<t.find("[ui-view]").length?e.$watch(function(){return t.find(".form-group").length},function(){n.forEach(function(e){angular.isFunction(e)?e():(e.length(),e.inputs.forEach(function(e){e()}))}),r(e,t,n=[])}):r(e,t,n)}}}),angular.module("uaaUIApp").directive("passwordStrengthBar",function(){return{replace:!0,restrict:"E",template:'<div id="strength"><small translate="global.messages.validate.newpassword.strength">Password strength:</small><ul id="strengthBar"><li class="point"></li><li class="point"></li><li class="point"></li><li class="point"></li><li class="point"></li></ul></div>',link:function(e,n,t){var r={colors:["#F00","#F90","#FF0","#9F0","#0F0"],mesureStrength:function(e){var t=0,n=[/[a-z]+/.test(e),/[A-Z]+/.test(e),/[0-9]+/.test(e),/[$-/:-?{-~!"^_`\[\]]/g.test(e)],r=$.grep(n,function(e){return!0===e}).length;return t+=2*e.length+(10<=e.length?1:0),t+=10*r,t=e.length<=6?Math.min(t,10):t,t=1===r?Math.min(t,10):t,t=2===r?Math.min(t,20):t,t=3===r?Math.min(t,40):t},getColor:function(e){var t=0;return{idx:(t=e<=10?0:e<=20?1:e<=30?2:e<=40?3:4)+1,col:this.colors[t]}}};e.$watch(t.passwordToCheck,function(e){if(e){var t=r.getColor(r.mesureStrength(e));n.removeClass("ng-hide"),n.find("ul").children("li").css({background:"#DDD"}).slice(0,t.idx).css({background:t.col})}})}}}),angular.module("uaaUIApp").config(["uibPagerConfig",function(e){e.itemsPerPage=20,e.previousText="«",e.nextText="»"}]),angular.module("uaaUIApp").config(["uibPaginationConfig",function(e){e.itemsPerPage=20,e.maxSize=5,e.boundaryLinks=!0,e.firstText="«",e.previousText="‹",e.nextText="›",e.lastText="»"}]),angular.module("uaaUIApp").directive("activeLink",["location",function(o){return{restrict:"A",link:function(e,t,n){var r=n.activeLink,a=n.href;a=a.substring(1),e.location=o,e.$watch("location.path()",function(e){a===e?t.addClass(r):t.removeClass(r)})}}}]),angular.module("uaaUIApp").controller("NavbarController",["$scope","$state","Principal","TokenHolder","ZoneHolder","ENV",function(t,n,r,e,a,o){t.$state=n,t.inProduction="prod"===o,t.isAuthenticated=r.isAuthenticated,t.isClient=r.isClient,t.isZoneMode=!a.isUAA(),r.token(e.getJwt().payload),a.current().then(function(e){t.zone=e,r.zone(e),r.isSwitchingZone()&&r.isAuthenticated()||r.identity(!0).catch(function(){"auth_redirect"!==n.current.name&&"home"!==n.current.name&&"home"!==n.current.parent&&n.go("home")})})}]),angular.module("file",[]).factory("readFile",["$window","$q",function(r,a){return function(e){var n=a.defer(),t=new r.FileReader;return t.onload=function(e){var t=e.target.result;n.resolve(t)},t.readAsText(e),n.promise}}]).directive("fileHandler",["readFile",function(n){return{link:function(e,t){t.on("change",function(e){var t=e.target.files[0];n(t).then(function(e){console.log(e)})})}}}]).directive("fileBrowser",function(){return{require:"ngModel",template:'<input type="file" style="display: none;" /><ng-transclude></ng-transclude>',transclude:!0,link:function(e,t,n,r){var a=t.children("input");r.$render=function(){},a.on("change",function(e){var t=e.target.files[0];r.$setViewValue(t)}),t.on("click",function(){a[0].click()})}}}),angular.module("uaaUIApp").factory("authInterceptor",["localStorageService","Setting",function(n,r){return{request:function(e){if(0!==e.url.indexOf("api"))return e;e.url=e.url.replace("api/",r.get().url),e.headers=e.headers||{};var t=n.get("token");return void 0===e.headers.Authorization&&t&&t.expires_at&&t.expires_at>(new Date).getTime()&&(e.headers.Authorization="Bearer "+t.access_token),e}}}]).factory("authExpiredInterceptor",["$rootScope","$q","$injector","localStorageService",function(e,n,r,a){return{responseError:function(e){if(!0===e.config.removeIfError&&401===e.status&&("invalid_token"==e.data.error||"unauthorized"==e.data.error)){a.remove("token");var t=r.get("Principal");t.isAuthenticated()&&t.authenticate(void 0)}return n.reject(e)}}}]),angular.module("uaaUIApp").factory("errorHandlerInterceptor",["$q","$rootScope",function(t,n){return{responseError:function(e){return n.$emit("uaaUIApp.httpError",e),t.reject(e)}}}]),angular.module("uaaUIApp").factory("zoneInterceptor",["$rootScope","$q","$location","localStorageService",function(e,t,n,r){return{request:function(e){if(0!==e.url.indexOf("api"))return e;var t=r.get("zone");return null!==t&&"uaa"!==t.id&&(e.headers["X-Identity-Zone-Id"]=t.id,e.headers["X-Identity-Zone-Subdomain"]=t.subdomain),e}}}]),angular.module("uaaUIApp").filter("characters",function(){return function(e,t,n){if(isNaN(t))return e;if(t<=0)return"";if(e&&e.length>t){if(e=e.substring(0,t),n)for(;" "===e.charAt(e.length-1);)e=e.substr(0,e.length-1);else{var r=e.lastIndexOf(" ");-1!==r&&(e=e.substr(0,r))}return e+"..."}return e}}).filter("words",function(){return function(e,t){if(isNaN(t))return e;if(t<=0)return"";if(e){var n=e.split(/\s+/);n.length>t&&(e=n.slice(0,t).join(" ")+"...")}return e}}),angular.module("uaaUIApp").service("Base64",function(){var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";this.encode=function(e){for(var t,n,r,a,o,i="",s="",l="",u=0;u<e.length;)r=(t=e.charCodeAt(u++))>>2,a=(3&t)<<4|(n=e.charCodeAt(u++))>>4,o=(15&n)<<2|(s=e.charCodeAt(u++))>>6,l=63&s,isNaN(n)?o=l=64:isNaN(s)&&(l=64),i=i+c.charAt(r)+c.charAt(a)+c.charAt(o)+c.charAt(l),t=n=s="",r=a=o=l="";return i},this.decode=function(e){var t,n,r,a,o="",i="",s="",l=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)t=c.indexOf(e.charAt(l++))<<2|(r=c.indexOf(e.charAt(l++)))>>4,n=(15&r)<<4|(a=c.indexOf(e.charAt(l++)))>>2,i=(3&a)<<6|(s=c.indexOf(e.charAt(l++))),o+=String.fromCharCode(t),64!==a&&(o+=String.fromCharCode(n)),64!==s&&(o+=String.fromCharCode(i)),t=n=i="",r=a=s="";return o}}).factory("StorageService",["$window",function(n){return{get:function(e){return JSON.parse(n.localStorage.getItem(e))},save:function(e,t){n.localStorage.setItem(e,JSON.stringify(t))},remove:function(e){n.localStorage.removeItem(e)},clearAll:function(){n.localStorage.clear()}}}]),angular.module("uaaUIApp").filter("capitalize",function(){return function(e,t){return null!=e&&(e=e.toLowerCase()),e.substring(0,1).toUpperCase()+e.substring(1)}}),angular.module("uaaUIApp").provider("AlertService",function(){this.toast=!1,this.$get=["$timeout","$sce",function(a,n){var r={factory:function(e){var t={type:e.type,msg:n.trustAsHtml(e.msg),id:e.alertId,timeout:e.timeout,toast:e.toast,position:e.position?e.position:"top right",scoped:e.scoped,close:function(e){return r.closeAlert(this.id,e)}};t.scoped||s.push(t);return t},isToast:function(){return o},add:function(e,t){e.alertId=i++;var n=this,r=this.factory(e);e.timeout&&0<e.timeout&&a(function(){n.closeAlert(e.alertId,t)},e.timeout);return r},closeAlert:function(e,t){var n=t||s;return this.closeAlertByIndex(n.map(function(e){return e.id}).indexOf(e),n)},closeAlertByIndex:function(e,t){return t.splice(e,1)},clear:function(){s.length=0},get:function(){return s},success:function(e,t,n){return this.add({type:"success",msg:e,params:t,timeout:l,toast:o,position:n})},error:function(e,t,n){return this.add({type:"danger",msg:e,params:t,timeout:l,toast:o,position:n})},info:function(e,t,n){return this.add({type:"info",msg:e,params:t,timeout:l,toast:o,position:n})},warning:function(e,t,n){return this.add({type:"warning",msg:e,params:t,timeout:l,toast:o,position:n})}},o=this.toast,i=0,s=[],l=5e3;return r}],this.showAsToast=function(e){this.toast=e}}),angular.module("uaaUIApp").directive("jhAlert",["AlertService",function(t){return{restrict:"E",template:'<div class="alerts" ng-cloak=""><div ng-repeat="alert in alerts" ng-class="[alert.position, {\'toast\': alert.toast}]"><div uib-alert ng-cloak="" ng-class="\'alert-{{alert.type}}\'" close="alert.close()"><pre ng-bind-html="alert.msg"></pre></div></div></div>',controller:["$scope",function(e){e.alerts=t.get(),e.$on("$destroy",function(){e.alerts=[]})}]}}]).directive("jhAlertError",["AlertService","$rootScope",function(a,t){return{restrict:"E",template:'<div class="alerts" ng-cloak=""><div ng-repeat="alert in error_alerts" ng-class="[alert.position, {\'toast\': alert.toast}]"><div uib-alert ng-cloak="" ng-class="\'alert-{{alert.type}}\'" close="alert.close(error_alerts)"><pre ng-bind-html="alert.msg"></pre></div></div></div>',controller:["$scope",function(r){r.error_alerts=[];var e=t.$on("uaaUIApp.httpError",function(e,t){var n;if(e.stopPropagation(),!1!==t.config.alert)switch(t.status){case 0:l("Server not reachable","error.server.not.reachable");break;case 400:var r=t.headers("X-uaaUIApp-error"),a=t.headers("X-uaaUIApp-params");if(r)l(r,r,{entityName:a});else if(t.data&&t.data.fieldErrors)for(n=0;n<t.data.fieldErrors.length;n++){var o=t.data.fieldErrors[n],i=o.field.replace(/\[\d*\]/g,"[]"),s=i.charAt(0).toUpperCase()+i.slice(1);l("Field "+s+" cannot be empty","error."+o.message,{fieldName:s})}else t.data&&t.data.message?l(t.data.message,t.data.message,t.data):t.data&&t.data.error?l(t.data.error_description,t.data.error,t.data):l(t.data);break;default:t.data&&t.data.message?l("<strong>"+t.status+" Error: </strong>"+t.data.message):t.data&&t.data.error_description?l("<strong>"+t.status+" Error: </strong>"+t.data.error_description):t.data&&t.data.error?l("<strong>"+t.status+" Error: </strong>"+t.data.error):l("<strong>"+t.status+" Error: </strong>"+JSON.stringify(t,null,"  "))}else console.log("No alert for "+t.status)});r.$on("$destroy",function(){null!=e&&(e(),r.error_alerts=[])});var l=function(e,t,n){r.error_alerts.push(a.add({type:"danger",msg:e,timeout:5e3,toast:a.isToast(),scoped:!0},r.error_alerts))}}]}}]),angular.module("uaaUIApp").service("ParseLinks",function(){this.parse=function(e){if(0==e.length)throw new Error("input must not be of zero length");var t=e.split(","),i={};return angular.forEach(t,function(e){var t=e.split(";");if(2!=t.length)throw new Error("section could not be split on ';'");var n=t[0].replace(/<(.*)>/,"$1").trim(),a={};n.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,t,n,r){a[t]=r});var r=a.page;angular.isString(r)&&(r=parseInt(r));var o=t[1].replace(/rel="(.*)"/,"$1").trim();i[o]=r}),i}}),angular.module("uaaUIApp").service("DateUtils",["$filter",function(t){this.convertLocaleDateToServer=function(e){return e?t("date")(e,"yyyy-MM-dd"):null},this.convertLocaleDateFromServer=function(e){if(e){var t=e.split("-");return new Date(t[0],t[1]-1,t[2])}return null},this.convertDateTimeFromServer=function(e){return e?new Date(e):null}}]),angular.module("uaaUIApp").service("DataUtils",["$filter",function(e){this.byteSize=function(e){if(!angular.isString(e))return"";function t(e,t){return-1!==t.indexOf(e,t.length-e.length)}return((n=e).length/4*3-(t("==",r=n)?2:t("=",r)?1:0)).toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" bytes";var n,r},this.abbreviate=function(e){return angular.isString(e)?e.length<30?e:e?e.substring(0,15)+"..."+e.slice(-10):"":""}}]),angular.module("uaaUIApp").directive("jhSort",function(){return{restrict:"A",scope:{predicate:"=jhSort",ascending:"=",callback:"&"},controller:["$scope",function(l){this.sort=function(e){e!==l.predicate?l.ascending=!0:l.ascending=!l.ascending,l.predicate=e,l.$apply(),l.callback()},this.applyClass=function(e){var t=e.parent().find("span.glyphicon"),n="glyphicon-sort",r="glyphicon-sort-by-attributes",a="glyphicon-sort-by-attributes-alt",o=n+" "+a,i=r,s=e.find("span.glyphicon");l.ascending||(o=n+" "+r,i=a),t.removeClass(r+" "+a),t.addClass(n),s.removeClass(o),s.addClass(i)}}]}}).directive("jhSortBy",function(){return{restrict:"A",scope:!1,require:"^jhSort",link:function(e,t,n,r){t.bind("click",function(){r.sort(n.jhSortBy),r.applyClass(t)})}}}),angular.module("uaaUIApp").service("SetUtils",function(){this.addItem=function(e,t){if(!angular.isUndefined(e)&&null!==e)if(angular.isArray(e)&&angular.isArray(t))for(var n=0;n<t.length;n++)e.push(t[n]);else angular.isArray(e)?e.push(t):e[t.key]=t.value},this.deleItem=function(e,t){angular.isUndefined(e)||null===e||(angular.isArray(e)?e.splice(t,1):delete e[t])},this.hasItem=function(e,t){return!angular.isUndefined(e)&&null!==e&&(angular.isArray(e)?-1!==e.indexOf(t):t in e)},this.toggleItem=function(e,t){if(!angular.isUndefined(e)&&null!==e)if(angular.isArray(e)){if(this.hasItem(e,t)){var n=e.indexOf(t);return void e.splice(n,1)}e.push(t)}else{if(this.hasItem(e,t))return void this.deleItem(e,t);this.addItem(e,t)}}}),angular.module("uaaUIApp").service("GuessSearch",["moment",function(l){l.suppressDeprecationWarnings=!0;var t=[],u=function(e,t){for(var n in e)angular.isFunction(e[n])&&(e[n]=e[n](t))};this.config=function(e){t=[],angular.isArray(e)?angular.forEach(e,function(e){t.push(e)}):t.push(e)},this.guess=function(o,i){var s=[];return angular.forEach(t,function(e){var t=null,n=o;if(angular.isFunction(e.support))e.support(o,i)&&(t=angular.copy(e.data));else if("moment"===e.support){if(o){var r=l(o);r.isValid()&&(t=angular.copy(e.data),n={moment:r,text:o})}}else if("string"===e.support)angular.isString(o)&&""!==o&&(t=angular.copy(e.data));else if("url"===e.support)try{new URL(o),t=angular.copy(e.data)}catch(e){}else"email"===e.support?angular.isString(o)&&-1!==o.indexOf("@")&&(t=angular.copy(e.data)):!0===e.support&&(t=angular.copy(e.data));if(null!==t)if(angular.isFunction(t)&&(t=t(n)),angular.isArray(t)){var a=t;angular.forEach(a,function(e){u(e,n),s.push(e)})}else u(t,n),s.push(t)}),s}}]),angular.module("uaaUIApp").config(["$stateProvider",function(e){e.state("setting",{parent:"home",url:"/setting",data:{authorities:["ROLE_ADMIN"],pageTitle:"Setting@UaaUI"},onEnter:["$stateParams","$state","$uibModal",function(e,t,n){n.open({templateUrl:"scripts/app/ui/setting/setting.html",controller:"SettingController",size:"lg",resolve:{}}).result.then(function(e){t.go("home",null,{reload:!0})},function(){t.go("home",null,{reload:!0})})}]})}]),angular.module("uaaUIApp").controller("SettingController",["$scope","$stateParams","$uibModalInstance","Setting","AlertService",function(t,e,n,r,a){t.setting=r.get(),t.count=5;t.save=function(){var e;t.isSaving=!0,r.set(t.setting),e=t.setting,t.isSaving=!1,n.close(e)},t.clear=function(){n.dismiss("cancel")},t.goingDebug=function(){a.clear(),0===t.count?(t.setting.debug=!t.setting.debug,r.set(t.setting),t.count=5):(a.info("<strong>UI: </strong>click "+t.count+" times to enter/exit debug mode"),t.count=t.count-1)}}]),angular.module("uaaUIApp").config(["$stateProvider",function(e){e.state("password",{parent:"home",views:{login:{templateUrl:"scripts/app/ui/login/password.html",controller:"LoginPasswordController"}}}).state("authorization_code",{parent:"home",views:{login:{templateUrl:"scripts/app/ui/login/authorization_code.html",controller:"LoginAuthorizationCodeController"}}}).state("implicit",{parent:"home",views:{login:{templateUrl:"scripts/app/ui/login/implicit.html",controller:"LoginImplicitController"}}}).state("client_credentials",{parent:"home",views:{login:{templateUrl:"scripts/app/ui/login/client_credentials.html",controller:"LoginClientCredentialsController"}}}).state("auto_login",{parent:"home",views:{login:{templateUrl:"scripts/app/ui/login/auto_login.html",controller:"LoginAutoLoginController"}}}).state("auth_redirect",{parent:"site",url:"/auth_redirect?code&state&error&error_description&token_type&access_token&id_token&expires_in&scope",params:{code:null,state:null,error:null,error_description:null,token_type:null,access_token:null,id_token:null,expires_in:null,scope:null},views:{"content@":{templateUrl:"scripts/app/ui/login/redirect.html",controller:"AuthRedirectController"}}}).state("passcode",{parent:"home",views:{login:{templateUrl:"scripts/app/ui/login/passcode.html",controller:"LoginPasscodeController"}}})}]),angular.module("uaaUIApp").controller("LoginPasswordController",["$scope","$state","$stateParams","Setting","TokenServerProvider","TokenHolder","Principal",function(t,n,e,r,a,o,i){t.setting=r.get(),t.uaa={url:t.setting.url,clientId:t.setting.clientId,clientSecret:t.setting.clientSecret,username:t.setting.username,password:t.setting.password},t.login=function(){a.password(t.uaa).then(function(e){o.set(e.data),i.token(o.getJwt().payload),n.go("token")}).catch(function(e){t.error=!0,t.errorMessage=e.error_description})}}]),angular.module("uaaUIApp").controller("LoginPasscodeController",["$scope","$state","$stateParams","Setting","TokenServerProvider","SSOServerProvider","TokenHolder","Principal",function(t,n,e,r,a,o,i,s){t.setting=r.get(),t.uaa={url:t.setting.url,clientId:t.setting.clientId,clientSecret:t.setting.clientSecret},t.goPasscode=function(){o.start_passcode({url:r.get().url})},t.pastePasscode=function(){navigator.clipboard.readText().then(function(e){t.uaa.passcode=e,t.$apply()}).catch(function(e){t.error=!0,t.errorMessage="Failed to read clipboard contents: "+e})},t.login=function(){a.passcode(t.uaa).then(function(e){i.set(e.data),s.token(i.getJwt().payload),s.uaaLogin(!0),n.go("token")}).catch(function(e){t.error=!0,t.errorMessage=e.error_description})}}]),angular.module("uaaUIApp").controller("LoginAuthorizationCodeController",["$scope","$state","$stateParams","$location","Setting","TokenServerProvider","TokenHolder","Principal",function(t,n,e,r,a,o,i,s){t.setting=a.get(),t.uaa={url:t.setting.url,clientId:t.setting.clientId,redirect_uri:r.absUrl().replace(/#\/.*/gi,t.setting.authRedirectUrl),state:""},t.login=function(){t.uaa.auth_url=t.setting.url+t.setting.authUrlPath,o.start_authorization_code(t.uaa,t).then(function(e){i.set(e),s.token(i.getJwt().payload),n.go("token")}).catch(function(e){t.error=e.error,t.errorMessage=e.error_description})}}]),angular.module("uaaUIApp").controller("LoginImplicitController",["$scope","$state","$stateParams","$location","Setting","TokenServerProvider","TokenHolder","Principal",function(t,n,e,r,a,o,i,s){t.setting=a.get(),t.uaa={url:t.setting.url,clientId:t.setting.clientId,redirect_uri:r.absUrl().replace(/#\/.*/gi,t.setting.authRedirectUrl),state:""},t.login=function(){t.uaa.auth_url=t.setting.url+t.setting.authUrlPath,o.start_implicit(t.uaa,t).then(function(e){i.set(e),s.token(i.getJwt().payload),n.go("token")}).catch(function(e){t.error=!0,t.errorMessage=e.error_description})}}]),angular.module("uaaUIApp").controller("LoginAutoLoginController",["$scope","$state","$stateParams","$location","Setting","TokenServerProvider","TokenHolder","Principal","AutoLogin",function(t,n,e,r,a,o,i,s,l){t.setting=a.get(),t.uaa={url:t.setting.url,clientId:t.setting.clientId,clientSecret:t.setting.clientSecret,redirect_uri:r.absUrl().replace(/#\/.*/gi,t.setting.authRedirectUrl),state:"",username:t.setting.username,password:t.setting.password},t.login=function(){l.code(t.uaa).then(function(e){t.uaa.auth_url=e.data.path.replace(/^\//gi,t.setting.url),t.uaa.code=e.data.code,o.start_authorization_code(t.uaa,t).then(function(e){i.set(e),s.token(i.getJwt().payload),n.go("token")}).catch(function(e){t.error=!0,t.errorMessage=e.error_description})})}}]),angular.module("uaaUIApp").controller("LoginClientCredentialsController",["$scope","$state","$stateParams","Setting","TokenServerProvider","TokenHolder","Principal",function(t,n,e,r,a,o,i){t.setting=r.get(),t.uaa={url:t.setting.url,clientId:t.setting.clientId,clientSecret:t.setting.clientSecret},t.login=function(){a.client(t.uaa).then(function(e){o.set(e.data),i.token(o.getJwt().payload),n.go("token")}).catch(function(e){t.error=!0,t.errorMessage=e.error_description})}}]),angular.module("uaaUIApp").controller("AuthRedirectController",["$scope","$window","$state","$stateParams","TokenServerProvider","TokenHolder","Principal",function(n,e,r,t,a,o,i){n.error=null,n.errorMessage="",a.end_redirect(n,e,t).then(function(t){a.end_data(t).then(function(e){o.set(e),i.token(e),r.go("token")}).catch(function(e){n.error=!0,n.errorMessage="Error with data to token"+angular.toJson(t)})}).catch(function(e){n.error=e.error,n.errorMessage=e.error_description})}]),angular.module("uaaUIApp").config(["$stateProvider",function(e){e.state("token",{parent:"uaa",url:"/token",data:{authorities:[],pageTitle:"TokenDetails@UaaUI"},views:{"content@":{templateUrl:"scripts/app/ui/token/token.html",controller:"TokenController"}}})}]),angular.module("uaaUIApp").controller("TokenController",["$scope","$rootScope","$state","$location","TokenServerProvider","TokenHolder","Principal","SSOServerProvider","AutoLogin","Setting","AlertService",function(r,e,t,n,a,o,i,s,l,u,c){null!==o.get()?(r.setting=u.get(),r.token=o.getJwt().payload,r.removeToken=function(){o.remove(),i.authenticate(void 0),t.go("home",null,{reload:!0})},r.isRefresh=o.isSupportRefresh,r.refreshToken=function(){var e={clientId:r.setting.clientId,clientSecret:r.setting.clientSecret,token:o.get().refresh_token};a.refresh(e).then(function(e){o.set(e.data),i.token(o.getJwt().payload),r.token=o.getJwt().payload,c.success("<strong>UI: </strong>Refresh success!")}).catch(function(e){r.error=!0,r.errorMessage=e.error_description})},r.isSSO=i.isUAALogin,r.logoutUaa=function(){var e={url:r.setting.url,clientId:r.setting.clientId,redirect_uri:n.absUrl().replace(/#\/.*/gi,r.setting.authRedirectUrl)};s.start_logout(e,r).then(function(){i.uaaLogin(!1),c.success("<strong>UI: </strong>Logout success!")})},r.sso={username:r.setting.username,password:r.setting.password},r.loginUaa=function(){l.code({url:r.setting.url,clientId:r.setting.clientId,clientSecret:r.setting.clientSecret,username:r.sso.username,password:r.sso.password}).then(function(e){s.start_autologin({url:r.setting.url,code:e.data.code,clientId:r.setting.clientId}),i.uaaLogin(!0),c.warning("<strong>UI: </strong>Unable to get login status, default is login!")}).catch(function(e){c.error(e.data.error_description)})},r.checkUaaSSO=function(){var e=u.get(),t=r.token.user_id;if("session_management"===e.sessionCheckUrl){var n=sjcl.hash.sha256.hash(e.clientId+" "+window.location.origin+" "+t+" ui");t=sjcl.codec.hex.fromBits(n)+".ui"}s.start_session({url:e.url+e.sessionCheckUrl,clientId:e.clientId,messageOrigin:window.location.origin,userId:t},r).then(function(e){"changed"===e.text?i.uaaLogin(!1):i.uaaLogin(!0)})}):t.go("home")}]),angular.module("uaaUIApp").config(["$stateProvider",function(e){e.state("user-info",{parent:"uaa",url:"/user-info",data:{authorities:[],pageTitle:"UserInfo@UaaUI"},views:{"content@":{templateUrl:"scripts/app/uaa/user-info/user-info.html",controller:"UserInfoController"}}})}]),angular.module("uaaUIApp").controller("UserInfoController",["$scope","UserInfo","UserPassword","Passcode","SSOServerProvider","AlertService","Setting",function(t,e,n,r,a,o,i){e.get().$promise.then(function(e){t.userInfo=e}),t.password={},t.changePassword=function(){n.change({id:t.userInfo.user_id},t.password).$promise.then(function(e){o.success(e.message),t.password.oldPassword=t.password.password,t.password.password=""})},t.getPasscode=function(){a.start_passcode({url:i.get().url})}}]),angular.module("uaaUIApp").config(["$stateProvider",function(e){e.state("server-info",{parent:"uaa",url:"/server-info",data:{authorities:[],pageTitle:"ServerInfo@UaaUI"},views:{"content@":{templateUrl:"scripts/app/uaa/server-info/server-info.html",controller:"ServerInfoController"}}})}]),angular.module("uaaUIApp").controller("ServerInfoController",["$scope","Info",function(t,e){e.get().$promise.then(function(e){t.serverInfo=e})}]),angular.module("uaaUIApp").config(["$stateProvider",function(e){e.state("zone-management",{parent:"uaa",url:"/zone-management",data:{authorities:["ROLE_ADMIN"],pageTitle:"ZoneManagement@UaaUI"},views:{"content@":{templateUrl:"scripts/app/uaa/zone-management/zone-management.html",controller:"ZoneManagementController"}},resolve:{}}).state("zone-management-detail",{parent:"uaa",url:"/zone/:id",data:{authorities:["ROLE_ADMIN"],pageTitle:"ZoneManagementDetail@UaaUI"},views:{"content@":{templateUrl:"scripts/app/uaa/zone-management/zone-management-detail.html",controller:"ZoneManagementDetailController"}},resolve:{entity:["Zone","$stateParams",function(e,t){return e.get({id:t.id})}]}}).state("zone-management.new",{parent:"zone-management",url:"/new",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal",function(t,e){e.open({templateUrl:"scripts/app/uaa/zone-management/zone-management-edit.html",controller:"ZoneManagementEditController",size:"lg",resolve:{entity:["Zone",function(e){return new e}]}}).result.then(function(e){t.go("zone-management",null,{reload:!0})},function(){t.go("zone-management")})}]}).state("zone-management.edit",{parent:"zone-management",url:"/{id}/edit",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal","$stateParams",function(t,e,n){e.open({templateUrl:"scripts/app/uaa/zone-management/zone-management-edit.html",controller:"ZoneManagementEditController",size:"lg",resolve:{entity:["Zone",function(e){return e.get({id:n.id})}]}}).result.then(function(e){t.go("zone-management",null,{reload:!0})},function(){t.go("^")})}]}).state("zone-management.delete",{parent:"zone-management",url:"/{id}/delete",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal","$stateParams",function(t,e,n){e.open({templateUrl:"scripts/app/uaa/zone-management/zone-management-delete.html",controller:"ZoneManagementDeleteController",size:"md",resolve:{entity:["Zone",function(e){return e.get({id:n.id})}]}}).result.then(function(e){t.go("zone-management",null,{reload:!0})},function(){t.go("^")})}]}).state("zone-management.change",{parent:"zone-management",url:"/{id}/change",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal","$stateParams",function(t,e,n){e.open({templateUrl:"scripts/app/uaa/zone-management/zone-management-change.html",controller:"ZoneManagementChangeController",size:"md",resolve:{entity:["Zone",function(e){return e.get({id:n.id})}]}}).result.then(function(e){t.go("home",null,e)},function(){t.go("^")})}]}).state("zone-management-detail.edit",{parent:"zone-management-detail",url:"/zone/:id/edit",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal","$stateParams",function(t,e,n){e.open({templateUrl:"scripts/app/uaa/zone-management/zone-management-edit.html",controller:"ZoneManagementEditController",size:"lg",resolve:{entity:["Zone",function(e){return e.get({id:n.id})}]}}).result.then(function(e){t.go("zone-management-detail",null,{reload:!0})},function(){t.go("^")})}]}).state("zone-management-detail.client",{parent:"zone-management-detail",url:"/zone/:id/client",onEnter:["$state","$uibModal","$stateParams",function(t,e,n){e.open({templateUrl:"scripts/app/uaa/client-management/client-management-edit.html",controller:"ClientManagementEditController",size:"lg",resolve:{entity:["Client",function(e){return new e}],zoneId:["$stateParams",function(e){return e.id}]}}).result.then(function(e){t.go("zone-management-detail",null,{reload:!0})},function(){t.go("^")})}]})}]),angular.module("uaaUIApp").controller("ZoneManagementController",["$scope","$state","Zone","ZoneHolder","Principal",function(t,e,n,r,a){t.zones=[],t.loadAll=function(){n.query({},function(e){t.zones=e})},t.loadAll(),t.setActive=function(t,e){t.active=e,n.update({id:t.id},t,function(e){delete e.$promise,delete e.$resolved,angular.merge(t,e)})},t.canChangeZone=function(e){return"uaa"!==e},t.clear=function(){t.zone={},t.editForm.$setPristine(),t.editForm.$setUntouched()}}]),angular.module("uaaUIApp").controller("ZoneManagementDetailController",["$scope","$state","$q","$filter","ZoneHolder","entity","Group","ZONE_SCOPES",function(a,e,n,o,t,r,i,s){a.zone=r,a.isZoneMode=!t.isUAA(),a.isAllowSwitching=function(){return t.isUAA()&&"uaa"!==a.zone.id},a.exitZoneMode=function(){t.reset(),e.go("home",null,{reload:!0})},a.ui={groups:[]},a.hasGroup=function(e){return!!e.has},a.toggleGroup=function(t){t.has?i.delete({id:t.has.id},function(){t.has=void 0}):i.save({displayName:t.name,description:t.description},function(e){t.has=e})};!function(){var e;if(angular.isUndefined(a.zone.$promise)){var t=n.defer();t.resolve(a.zone),e=t.promise}else e=a.zone.$promise;e.then(function(e){angular.forEach(s,function(n){var r={title:n.template.replace("zones.<zone id>.",""),name:n.template.replace("<zone id>",e.id),description:n.description,has:void 0};a.ui.groups.push(r),i.query({filter:"displayname eq '"+r.name+"'"},function(e){var t=o("filter")(e.resources,{displayName:n.name},!0);1===t.length&&(r.has=t[0])})})})}()}]),angular.module("uaaUIApp").controller("ZoneManagementEditController",["$scope","$q","$http","$uibModalInstance","entity","Zone","MFAProvider","IdentityProvider","Base64","SetUtils","HTTP_METHIDS","HTTP_HEADERS",function(a,o,e,t,n,r,i,s,l,u,c,d){a.zone=n;var p=function(e){a.isSaving=!1,t.close(e)},g=function(e){a.isSaving=!1},m={branding:function(){0===Object.keys(a.branding.consent).length&&(a.branding.consent=null),a.branding.productLogo=a.imageModelToBase64(a.branding_productLogo),a.branding.squareLogo=a.imageModelToBase64(a.branding_squareLogo),a.branding.banner.logo=a.imageModelToBase64(a.branding_banner_logo)}};a.save=function(){a.isSaving=!0,angular.forEach(m,function(e){e()}),angular.isDefined(a.zone.$promise)?r.update({id:a.zone.id},a.zone,p,g):r.save(a.zone,p,g)},a.clear=function(){t.dismiss("cancel")},a.addItem=u.addItem,a.deleItem=u.deleItem,a.hasItem=u.hasItem,a.toggleItem=u.toggleItem,a.time_units={S:{to:function(e){return e},from:function(e){return e}},M:{to:function(e){return e/60},from:function(e){return 60*e}},H:{to:function(e){return e/3600},from:function(e){return 3600*e}},D:{to:function(e){return e/86400},from:function(e){return 86400*e}}},a.changeUnit=function(e,t,n){var r=n[e.last_unit].from(e.value);e.value=n[t].to(r),e.last_unit=t},a.assignmentUnit=function(e,t){var n=t[e.unit].from(e.value);return e.original=n,angular.isUndefined(n)?0:n},a.http={methods:c,headers:d},a.base64ToImageModel=function(e,t){var n=o.defer();if(angular.isUndefined(e)||null===e)return n.reject("undefined base64 param"),n.promise;angular.isUndefined(t)&&(t={});var r=l.decode(e);return/data:.*\/.*;base64,/g.test(r)?(t.format="dataUrl",t.url=r):(t.format="base64",t.url="data:image/png;base64,"+e),n.resolve(t),n.promise},a.fileToImageModel=function(e,t){var n=o.defer();if(angular.isUndefined(e))return n.reject("undefined file"),n.promise;angular.isUndefined(t)&&(t={});var r=new FileReader;return r.onload=function(e){a.$apply(function(){t.default&&(t.default=!1),t.url=e.target.result,n.resolve(t)})},r.readAsDataURL(e),n.promise},a.imageModelToBase64=function(e){return e.default?null:"dataUrl"===e.format?l.encode(e.url):"base64"===e.format?e.url.replace(/data:.*\/.*;base64,/g,""):null},a.activeTab=function(e){a.active=e},a.changeKey=function(e){a.samlConfig.activeKeyId=e,a.key=a.samlConfig.keys[e]},a.providers={mfa:null,identity:null},i.query({},function(e){a.providers.mfa=e}),s.query({},function(e){a.providers.identity=e}),a.initRawConfig=function(){a.config=JSON.stringify(a.zone.config,null,"  ")},a.configChange=function(){a.zone.config=JSON.parse(a.config)};var f={tokenPolicy:function(){a.tokenPolicy_accessTokenValidity={last_unit:"S",unit:"S",value:a.tokenPolicy.accessTokenValidity,original:a.tokenPolicy.accessTokenValidity},a.tokenPolicy_refreshTokenValidity={last_unit:"S",unit:"S",value:a.tokenPolicy.refreshTokenValidity,original:a.tokenPolicy.refreshTokenValidity}},clientSecretPolicy:function(){},corsPolicy:function(){angular.merge(a.corsPolicy,{defaultConfiguration:{allowedHeaders:[],allowedMethods:[],allowedOriginPatterns:[],allowedOrigins:[],allowedUriPatterns:[],allowedUris:[]},xhrConfiguration:{allowedHeaders:[],allowedMethods:[],allowedOriginPatterns:[],allowedOrigins:[],allowedUriPatterns:[],allowedUris:[]}},a.corsPolicy)},prompts:function(){angular.merge(a.prompts,[{name:"username",type:"text",text:"Email"},{name:"password",type:"password",text:"Password"},{name:"passcode",type:"password",text:"Password"}],a.prompts)},links:function(){angular.merge(a.links,{logout:{whitelist:[]},selfService:{}},a.links)},branding:function(){angular.merge(a.branding,{footerLinks:{},banner:{},consent:{}},a.branding),a.base64ToImageModel(a.branding.productLogo).then(function(e){a.branding_productLogo=e}).catch(function(){e({method:"GET",url:"assets/images/product-logo.png",responseType:"blob"}).then(function(e){var t=new FileReader;t.readAsDataURL(e.data),t.onloadend=function(){a.branding_productLogo={url:t.result,format:"base64",default:!0}}})}),a.base64ToImageModel(a.branding.squareLogo).then(function(e){a.branding_squareLogo=e}).catch(function(){e({method:"GET",url:"assets/images/square-logo.png",responseType:"blob"}).then(function(e){var t=new FileReader;t.readAsDataURL(e.data),t.onloadend=function(){a.branding_squareLogo={url:t.result,format:"base64",default:!0}}})}),a.base64ToImageModel(a.branding.banner.logo).then(function(e){a.branding_banner_logo=e}).catch(function(){a.branding_banner_logo={url:"",format:"base64",default:!0}})},samlConfig:function(){angular.merge(a.samlConfig,{keys:{}},a.samlConfig)},mfaConfig:function(){angular.merge(a.mfaConfig,{identityProviders:[]},a.mfaConfig)},userConfig:function(){angular.merge(a.userConfig,{defaultGroups:[]},a.userConfig)},other:function(){}};!function(){var e;if(angular.isUndefined(a.zone.$promise)){var t=o.defer();t.resolve(a.zone),e=t.promise}else e=a.zone.$promise;e.then(function(n){angular.isUndefined(n.config)&&(n.config={}),angular.merge(n.config,{tokenPolicy:{},clientSecretPolicy:{},corsPolicy:{},prompts:[],links:{},branding:{},samlConfig:{},mfaConfig:{},userConfig:{}},n.config),angular.forEach(f,function(e,t){t in n.config?a[t]=n.config[t]:a[t]=n.config,angular.isFunction(e)&&e()})})}()}]),angular.module("uaaUIApp").controller("ZoneManagementDeleteController",["$scope","$uibModalInstance","entity","Zone",function(e,t,n,r){e.zone=n,e.clear=function(){t.dismiss("cancel")},e.confirmDelete=function(e){r.delete({id:e},function(){t.close(!0)})}}]),angular.module("uaaUIApp").controller("ZoneManagementChangeController",["$scope","$uibModalInstance","$stateParams","entity","ZoneHolder","Principal",function(t,n,e,r,a,o){t.zone=r,t.clear=function(){n.dismiss("cancel")},t.canSwitchingZone=o.canSwitchingZone(e.id),t.confirmChange=function(e){a.change(e).then(function(e){t.canSwitchingZone;n.close({reload:!0})})}}]),angular.module("uaaUIApp").config(["$stateProvider",function(e){e.state("client-management",{parent:"uaa",url:"/client-management",data:{authorities:["ROLE_ADMIN"],pageTitle:"ClientManagement@UaaUI"},views:{"content@":{templateUrl:"scripts/app/uaa/client-management/client-management.html",controller:"ClientManagementController"}},resolve:{}}).state("client-management-detail",{parent:"uaa",url:"/client/:id",data:{authorities:["ROLE_ADMIN"],pageTitle:"ClientManagementDetail@UaaUI"},views:{"content@":{templateUrl:"scripts/app/uaa/client-management/client-management-detail.html",controller:"ClientManagementDetailController"}},resolve:{}}).state("client-management.new",{parent:"client-management",url:"/new",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal",function(t,e){e.open({templateUrl:"scripts/app/uaa/client-management/client-management-edit.html",controller:"ClientManagementEditController",size:"lg",resolve:{entity:["Client",function(e){return new e}],zoneId:null}}).result.then(function(e){t.go("client-management",null,{reload:!0})},function(){t.go("client-management")})}]}).state("client-management.edit",{parent:"client-management",url:"/{id}/edit",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal","$stateParams",function(t,e,n){e.open({templateUrl:"scripts/app/uaa/client-management/client-management-edit.html",controller:"ClientManagementEditController",size:"lg",resolve:{entity:["Client",function(e){return e.get({id:n.id})}],zoneId:null}}).result.then(function(e){t.go("client-management",null,{reload:!0})},function(){t.go("^")})}]}).state("client-management.delete",{parent:"client-management",url:"/{id}/delete",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal","$stateParams",function(t,e,n){e.open({templateUrl:"scripts/app/uaa/client-management/client-management-delete.html",controller:"ClientManagementDeleteController",size:"md",resolve:{entity:["Client",function(e){return e.get({id:n.id})}]}}).result.then(function(e){t.go("client-management",null,{reload:!0})},function(){t.go("^")})}]}).state("client-management.meta",{parent:"client-management",url:"/{id}/meta",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal","$stateParams",function(t,e,n){e.open({templateUrl:"scripts/app/uaa/client-management/client-management-meta.html",controller:"ClientManagementMetaController",size:"lg",resolve:{entity:["ClientMeta",function(e){return e.get({id:n.id})}]}}).result.then(function(e){t.go("client-management",null,{reload:!0})},function(){t.go("^")})}]})}]),angular.module("uaaUIApp").controller("ClientManagementController",["$scope","$state","$filter","Client","ClientMeta","Group","IdentityProvider","AlertService","Base64","SetUtils","Search","GRANTS","GROUPS",function(a,o,i,s,e,t,r,l,n,u,c,d,p){var g,m;a.apps=[],a.loadAllApp=function(){return e.query().$promise.then(function(e){a.apps=e,angular.forEach(e,function(e){var t=n.decode(e.appIcon);/data:.*\/.*;base64,/g.test(t)?e.appIconUrl=t:e.appIconUrl="data:image/png;base64,"+e.appIcon})})},a.clients=[],a.search="",a.pageTotal=0,a.pageNumber=1,a.pageSize=5,a.loadPage=function(e,t,n){var r=(a.pageNumber-1)*a.pageSize+1;s.query({startIndex:r,count:a.pageSize,filter:e,sortBy:t,sortOrder:n},function(e){a.clients=e.resources,a.pageTotal=e.totalResults})},a.loadAllApp(),a.loadPage(),a.clear=function(){a.client={},a.editForm.$setPristine(),a.editForm.$setUntouched()},a.getScopeLabel=function(e,t){return!0===t||"true"===t||u.hasItem(t,"true")?"label-success":-1!=e.indexOf("*")?"label-danger":-1!=t.indexOf(e)?"label-success":"label-primary"},a.getScopeIcon=function(e,t){return!0===t||"true"===t||u.hasItem(t,"true")?"glyphicon-ok":-1!=e.indexOf("*")?"glyphicon-asterisk":-1!=t.indexOf(e)?"glyphicon-ok":"glyphicon-folder-close"},a.getScopeTipIndex=function(e,t){return!0===t||"true"===t||u.hasItem(t,"true")?0:-1!=e.indexOf("*")?1:-1!=t.indexOf(e)?0:2},a.goGroupListOrDetail=function(n){var r=!1,e="eq";-1!==n.indexOf("*")&&(r=!0,e="co",n=n.replace("*","")),t.query({filter:"displayname "+e+" '"+n+"'"},function(e){var t=i("filter")(e.resources,{displayName:n},!r);1===t.length?o.go("group-management-detail",{id:t[0].id}):1<t.length?o.go("group-management",{search:n}):l.warning("<strong>UI: </strong>"+n+" is not Group!",{timeout:1e6})})},a.goIdentityProviderDetail=function(n){r.query({},function(e){var t=i("filter")(e,{originKey:n},!0);1===t.length?o.go("identity-provider-detail",{id:t[0].id,type:t[0].type}):l.warning("<strong>UI: </strong>"+n+" is not Identity Provider!")})},a.grants={},angular.forEach(d,function(e){if(e.grant){var t=e.value?e.value:e.name;a.grants[t]=e}}),a.selected={value:[]},a.filters=c.init(a.loadPage,a.selected,[{name:"ID",field:"client_id",sort:!0,any:!0},{name:"Url",field:"web_server_redirect_uri",url:!0,any:!0},{name:"Scope",field:"scope",any:!0,enum:(m=[],angular.forEach(p,function(e){var t={group:"Scope",icon:"glyphicon-folder-close",name:e,field:"scope",operator:"co"};t.value=e,m.push(t)}),m)},{name:"Grant",field:"authorized_grant_types",any:!0,enum:(g=[],angular.forEach(d,function(e){if(e.grant){var t={group:"Grant",icon:"glyphicon-tag"};angular.merge(t,e),t.field="authorized_grant_types",t.operator="co",t.value=e.value?e.value:e.name,g.push(t)}}),g)},{name:"LastModified",field:"lastModified",moment:!0,sort:!0}],[{support:function(e){return!!e&&-1!==e.indexOf(".")},data:{group:"Scope",icon:"glyphicon-folder-close",name:c.usingText,field:"scope",operator:"co",value:c.usingText}}]),a.tagging=c.tagging,a.filtering=c.filtering,a.pagging=c.refreshing}]),angular.module("uaaUIApp").controller("ClientManagementDetailController",["$scope","$state","$stateParams","Client","ClientSecret","TokenServerProvider","TokenHolder","Principal","AlertService",function(n,r,e,t,a,o,i,s,l){"token-client"!==r.current.name&&r.go("token-client"),n.client={},n.load=function(e){n.isMe=i.getJwt().payload.client_id===e,t.get({id:e},function(e){n.client=e})},n.load(e.id),n.changeSecret=function(){o.client({clientId:n.client.client_id,clientSecret:n.secret.old_secret}).then(function(e){var t=e.data.access_token;a.change({id:n.client.client_id},{clientId:n.client.client_id,secret:n.secret.secret,token:t},function(e){l.success(e.message),n.isMe&&(i.remove(),s.authenticate(void 0),r.go("home",null,{reload:!0}))}).$promise})}}]),angular.module("uaaUIApp").controller("ClientManagementEditController",["$scope","$q","$uibModalInstance","entity","zoneId","Client","ZoneClient","IdentityProvider","SetUtils","GRANTS","GROUPS","RESOURCE_IDS",function(n,r,t,e,a,o,i,s,l,u,c,d){n.client=e,n.zoneId=a;var p=function(e){n.isSaving=!1,t.close(e)},g=function(e){n.isSaving=!1};n.save=function(){n.isSaving=!0,angular.isDefined(n.client.$promise)?o.update({id:n.client.client_id},n.client,p,g):null!==n.zoneId?i.save({id:n.zoneId},n.client,p,g):o.save(n.client,p,g)},n.clear=function(){t.dismiss("cancel")},n.ui={grants:{},groups:c,resourceIds:d},angular.forEach(u,function(e){if(e.grant){var t=e.value?e.value:e.name;n.ui.grants[t]=e}}),n.providers={identity:null},n.addItem=l.addItem,n.deleItem=l.deleItem,n.hasItem=l.hasItem,n.toggleItem=l.toggleItem;!function(){var e;if(angular.isUndefined(n.client.$promise)){var t=r.defer();t.resolve(n.client),e=t.promise}else e=n.client.$promise;e.then(function(e){angular.merge(e,{authorized_grant_types:[],redirect_uri:[],scope:[],resource_ids:[],authorities:[],autoapprove:angular.isUndefined(n.client.$promise)?["true"]:[],allowedproviders:[],required_user_groups:[]})}),s.query({},function(e){n.providers.identity=e})}()}]),angular.module("uaaUIApp").controller("ClientManagementDeleteController",["$scope","$uibModalInstance","entity","Client",function(e,t,n,r){e.client=n,e.clear=function(){t.dismiss("cancel")},e.confirmDelete=function(e){r.delete({id:e},function(){t.close(!0)})}}]),angular.module("uaaUIApp").controller("ClientManagementMetaController",["$scope","$stateParams","$uibModalInstance","entity","ClientMeta","Base64",function(n,e,t,r,a,o){n.client=r,n.file=null,n.imageUrl=null,n.imageFormat=!0,r.$promise.then(function(e){var t=o.decode(e.appIcon);/data:.*\/.*;base64,/g.test(t)?(n.imageUrl=t,n.imageFormat=!0):(n.imageUrl="data:image/png;base64,"+e.appIcon,n.imageFormat=!1)}),n.imageIsLoaded=function(e){n.$apply(function(){n.imageUrl=e.target.result,/data:image\/png;base64,/g.test(n.imageUrl)?n.imageFormat=!1:n.imageFormat=!0})},n.flashIcon=function(){var e=new FileReader;e.onload=n.imageIsLoaded,e.readAsDataURL(n.file)};var i=function(e){n.isSaving=!1,t.close(e)},s=function(e){n.isSaving=!1};n.save=function(){n.isSaving=!0,n.imageFormat?n.client.appIcon=o.encode(n.imageUrl):n.client.appIcon=n.imageUrl.replace(/data:.*\/.*;base64,/g,""),a.update({id:n.client.clientId},n.client,i,s)},n.clear=function(){t.dismiss("cancel")},n.disable=function(){n.isSaving=!0,n.client.appIcon=null,n.client.appLaunchUrl=null,n.client.showOnHomePage=!1,a.update({id:n.client.clientId},n.client,i,s)}}]),angular.module("uaaUIApp").controller("UserManagementLocationController",["$scope","$filter","$q","$uibModalInstance","entity","Group","Member","MemberType",function(l,u,r,e,t,n,c,d){l.user=t,l.members=[],l.clear=function(){e.dismiss("cancel")},l.selectItem=function(t,e){return e&&e.stopPropagation(),i(t).then(function(e){return 0===e.length?t.nochild=!0:delete t.nochild,e})},l.expandItem=function(t,e){e&&e.stopPropagation(),!0!==t.nochild&&(0<t.members.length?t.show=!t.show:l.selectItem(t).then(function(e){0<e.length&&(t.show=!t.show)}))},l.toggleItem=function(t,e){e&&e.stopPropagation(),"DIRECT"===t.type?c.remove({gid:t.id,id:l.user.id},function(e){a(t)?t.type="INDIRECT":t.type="NONE",o(t)}):c.add({gid:t.id},{origin:"uaa",type:"USER",value:l.user.id},function(e){t.type="DIRECT",o(t)})};var a=function(e){return 0<u("filter")(e.members,{type:"!NONE"},!0).length},o=function(e){angular.forEach(e.parents,function(e){"INDIRECT"!==e.type&&"NONE"!==e.type||(a(e)?e.type="INDIRECT":e.type="NONE",o(e))})},i=function(a){var t=r.defer(),n=function(e){var r=[];return angular.forEach(e,function(e){if("USER"!==e.type){var t,n=u("filter")(a.members,{id:e.value},!0);0<n.length?t=n[0]:(t={id:e.value,type:"NONE",members:[],parents:[],show:!1,nochild:!1},a.members.push(t),t.parents.push(a)),d.getName(e).then(function(e){t.name=e}),r.push(t)}}),r};return c.list({gid:a.id,returnEntities:!0}).$promise.then(n).then(function(e){t.resolve(e)}).catch(function(e){404===e.status?c.list({gid:a.id,returnEntities:!1}).$promise.then(n).then(function(e){t.resolve(e)}):t.reject(e)}),t.promise};!function(){var e;if(angular.isUndefined(l.user.$promise)){var t=r.defer();t.resolve(l.user),e=t.promise}else e=l.user.$promise;e.then(function(a){var o=[],i=function(e){var t;if(e.display){var n=e;t={id:n.value,name:n.display,type:n.type,members:[],parents:[],show:!1,nochild:!0}}else{var r=e;t={id:r.value,name:"",type:"NONE",members:[],parents:[],show:!1,nochild:!1},angular.isDefined(r.entity)?t.name=r.entity.displayName:d.getName(r).then(function(e){t.name=e})}return o.push(t),t},s=function(e){var t=u("filter")(l.members,{id:e.value},!0);if(0<t.length){var n=l.members.indexOf(t[0]);return l.members.splice(n,1),t[0]}var r=u("filter")(o,{id:e.value},!0);return 0<r.length?r[0]:null},e=function(n){angular.forEach(a.groups,function(e){var r=s(e);null===r&&(r=i(e),l.members.push(r));var t=n.shift();angular.forEach(t,function(e){if("GROUP"===e.type){var t=s(e);if(null===t){var n=u("filter")(a.groups,{value:e.value},!0);t=0<n.length?i(n[0]):i(e)}r.members.push(t),t.parents.push(r)}}),r.nochild=0===r.members.length,r.show=0!==r.members.length})},n=[];angular.forEach(a.groups,function(e){var t=c.list({gid:e.value,returnEntities:!0}).$promise;n.push(t)}),r.all(n).then(e).catch(function(){n=[],angular.forEach(a.groups,function(e){var t=c.list({gid:e.value,returnEntities:!1}).$promise;n.push(t)}),r.all(n).then(e)})})}()}]),angular.module("uaaUIApp").controller("UserManagementInviteController",["$scope","$stateParams","$uibModalInstance","$filter","clipboard","UserInvite","Setting",function(r,e,t,a,n,o,i){var s=function(e){r.isSaving=!1,e.new_invites.concat(e.failed_invites).forEach(function(e){var t=a("filter")(r.invites,{email:e.email},!0);if(1===t.length){var n=t[0];(n=angular.merge(n,e)).done=!0}})},l=function(e){r.isSaving=!1};r.params={client_id:i.get().clientId,redirect_uri:i.get().url},r.invites=[{email:"",done:!1}],r.addInvite=function(){r.invites.push({email:"",done:!1})},r.deleInvite=function(e){r.invites.splice(e,1)},r.save=function(){r.isSaving=!0;var t={emails:[]};r.invites.forEach(function(e){t.emails.push(e.email)}),o.invite(r.params,t,s,l)},r.clear=function(){t.dismiss("cancel")},r.copyText=n.copyText}]),angular.module("uaaUIApp").controller("UserManagementDetailController",["$scope","$state","$stateParams","$location","clipboard","User","UserPassword","UserStatus","UserVerify","UserVerifyLink","UserMFARegistration","Password","Email","TokenServerProvider","TokenHolder","Principal","Setting","AlertService",function(n,t,e,r,a,o,i,s,l,u,c,d,p,g,m,f,h,v){"token-user"!==t.current.name&&t.go("token-user");var y=h.get();n.user={},n.load=function(t){f.identity().then(function(e){n.isMe=e.user_id===t}).catch(function(){n.isMe=!1}),o.get({id:t},function(e){n.user=e})},n.load(e.id),n.copyText=a.copyText,n.changePassword=function(){n.isMe||f.hasScope("password.write")||f.hasAuthority("password")?i.change({id:n.user.id},{oldPassword:n.secret.old_password,password:n.secret.password},function(e){v.success(e.message),n.isMe&&(m.remove(),f.authenticate(void 0),t.go("home",null,{reload:!0}))}).$promise:g.password({clientId:y.clientId,clientSecret:y.clientSecret,username:n.user.userName,password:n.secret.old_password}).then(function(e){var t=e.data.access_token;i.change({id:n.user.id},{oldPassword:n.secret.old_password,password:n.secret.password,token:t},function(e){v.success(e.message)}).$promise})},n.reset={password:"",code:""},n.resetPassword=function(t){d.reset({client_id:y.clientId,redirect_uri:r.absUrl().replace(/#\/.*/gi,"")},n.user.userName,function(e){t?d.change({},{code:e.code,new_password:n.reset.password},function(e){v.success("<strong>UI: </strong>reset password success!")}):n.reset.code=e.code})},n.email={email:"",code:""},n.changeEmail=function(t){p.verification({},{userId:n.user.id,email:n.email.email,client_id:y.clientId},function(e){v.warning('<strong>UI: </strong>bug <a target="_blank" href="https://github.com/cloudfoundry/uaa/issues/951">issues/951</a>!'),t?p.change({},e.code,function(e){v.success("<strong>UI: </strong>change email success!")}):n.email.code=e.code})},n.deleteMFA=function(){c.delete({id:n.user.id},function(){v.success("<strong>UI: </strong>delete mfa success!")})},n.unlockAccount=function(){s.change({id:n.user.id},{locked:!1},function(e){v.success("<strong>UI: </strong>Unlock account success!")}).$promise},n.expirePassword=function(){s.change({id:n.user.id},{passwordChangeRequired:!0},function(e){v.success("<strong>UI: </strong>Force user password to expire success!")}).$promise},n.verify={redirect_uri:r.absUrl().replace(/#\/.*/gi,""),verify_link:""},n.verifyUser=function(){l.verify({id:n.user.id},function(e){n.user=e,v.success("<strong>UI: </strong>Verify user success!")}).$promise},n.verifyLink=function(){u.verify({id:n.user.id,redirect_uri:n.verify.redirect_uri},function(e){n.verify.verify_link=e.verify_link,v.success("<strong>UI: </strong>Verify link create success!")}).$promise}}]),angular.module("uaaUIApp").controller("UserManagementEditController",["$scope","$q","$uibModalInstance","entity","User","IdentityProvider","SetUtils",function(n,r,t,e,a,o,i){n.user=e;var s=function(e){n.isSaving=!1,t.close(e)},l=function(e){n.isSaving=!1};n.save=function(){n.isSaving=!0,null!=n.user.id?a.update({id:n.user.id},n.user,s,l):a.save(n.user,s,l)},n.clear=function(){t.dismiss("cancel")},n.addItem=i.addItem,n.deleItem=i.deleItem,n.providers={identity:null};!function(){var e;if(angular.isUndefined(n.user.$promise)){var t=r.defer();t.resolve(n.user),e=t.promise}else e=n.user.$promise;e.then(function(e){angular.isUndefined(e.name)&&(e.name={}),angular.isUndefined(e.phoneNumbers)&&(e.phoneNumbers=[]),angular.isUndefined(e.emails)&&(e.emails=[{value:null,primary:!0}]),angular.isUndefined(e.active)&&(e.active=!0),angular.isUndefined(e.verified)&&(e.verified=!1),angular.isUndefined(e.origin)&&(e.origin="uaa"),angular.isUndefined(e.approvals)&&(e.approvals=[])}),o.query({},function(e){n.providers.identity=e})}()}]),angular.module("uaaUIApp").controller("UserManagementDeleteController",["$scope","$uibModalInstance","entity","User",function(e,t,n,r){e.user=n,e.clear=function(){t.dismiss("cancel")},e.confirmDelete=function(e){r.delete({id:e},function(){t.close(!0)})}}]),angular.module("uaaUIApp").controller("UserManagementController",["$scope","$stateParams","User","Search",function(a,e,o,t){a.users=[],a.pageTotal=0,a.pageNumber=1,a.pageSize=5,a.loadPage=function(e,t,n){var r=(a.pageNumber-1)*a.pageSize+1;o.query({startIndex:r,count:a.pageSize,filter:e,sortBy:t,sortOrder:n},function(e){a.pageTotal=e.totalResults,a.users=e.resources})},a.clear=function(){a.user={},a.editForm.$setPristine(),a.editForm.$setUntouched()},a.setActive=function(t,e){t.active=e,o.update({id:t.id},t,function(e){delete e.$promise,delete e.$resolved,angular.merge(t,e)})},a.selected={value:[]},a.filters=t.init(a.loadPage,a.selected,[{name:"ID",field:"id",sort:!0,any:!0},{name:"Name",field:"userName",sort:!0,any:!0},{name:"GivenName",field:"givenname",sort:!0,any:!0},{name:"FamilyName",field:"familyname",sort:!0,any:!0},{name:"Email",field:"email",email:!0,sort:!0,any:!0},{name:"Status",field:"active",enum:[{icon:"glyphicon-lock",name:"Activated",tags:"Activated",field:"active",operator:"eq",value:!0},{icon:"glyphicon-lock",name:"Desactivated",tags:"Desactivated",field:"active",operator:"eq",value:!1}]},{name:"Status",field:"verified",enum:[{icon:"glyphicon-flag",name:"Verified",tags:"Verified",field:"verified",operator:"eq",value:!0},{icon:"glyphicon-flag",name:"Desverified",tags:"Desverified",field:"verified",operator:"eq",value:!1}]},{name:"PreviousLogonTime",field:"previous_logon_success_time",moment:!0,sort:!0,value:function(e){return e.moment.valueOf()}},{name:"LastLogonTime",field:"last_logon_success_time",moment:!0,sort:!0,value:function(e){return e.moment.valueOf()}},{name:"PasswordLastModified",field:"passwd_lastmodified",moment:!0,sort:!0},{name:"Created",field:"created",moment:!0,sort:!0},{name:"LastModified",field:"lastModified",moment:!0,sort:!0}],[{support:function(e){return!!e&&-1!==e.indexOf(".")},data:{group:"Scope",icon:"glyphicon-folder-close",name:t.usingText,field:"scope",operator:"co",value:t.usingText}}]),a.tagging=t.tagging,a.filtering=t.filtering,a.pagging=t.refreshing,t.searching(e.search)}]),angular.module("uaaUIApp").config(["$stateProvider",function(e){e.state("user-management",{parent:"uaa",url:"/user-management?search",params:{search:""},data:{authorities:["ROLE_ADMIN"],pageTitle:"UserManagement@UaaUI"},views:{"content@":{templateUrl:"scripts/app/uaa/user-management/user-management.html",controller:"UserManagementController"}},resolve:{}}).state("user-management-detail",{parent:"uaa",url:"/user/:id",data:{authorities:["ROLE_ADMIN"],pageTitle:"UserManagementDetail@UaaUI"},views:{"content@":{templateUrl:"scripts/app/uaa/user-management/user-management-detail.html",controller:"UserManagementDetailController"}},resolve:{}}).state("user-management.location",{parent:"user-management",url:"/user/:id/location",data:{authorities:["ROLE_ADMIN"],pageTitle:"UserManagementDetail@UaaUI"},onEnter:["$state","$uibModal","$stateParams",function(t,e,n){e.open({templateUrl:"scripts/app/uaa/user-management/user-management-location.html",controller:"UserManagementLocationController",size:"lg",resolve:{entity:["User",function(e){return e.get({id:n.id})}]}}).result.then(function(e){t.go("user-management",null,{reload:!0})},function(){t.go("user-management")})}]}).state("user-management.new",{parent:"user-management",url:"/new",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal",function(t,e){e.open({templateUrl:"scripts/app/uaa/user-management/user-management-edit.html",controller:"UserManagementEditController",size:"lg",resolve:{entity:["User",function(e){return new e}]}}).result.then(function(e){t.go("user-management",null,{reload:!0})},function(){t.go("user-management")})}]}).state("user-management.edit",{parent:"user-management",url:"/{id}/edit",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal","$stateParams",function(t,e,n){e.open({templateUrl:"scripts/app/uaa/user-management/user-management-edit.html",controller:"UserManagementEditController",size:"lg",resolve:{entity:["User",function(e){return e.get({id:n.id})}]}}).result.then(function(e){t.go("user-management",null,{reload:!0})},function(){t.go("^")})}]}).state("user-management.delete",{parent:"user-management",url:"/{id}/delete",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal","$stateParams",function(t,e,n){e.open({templateUrl:"scripts/app/uaa/user-management/user-management-delete.html",controller:"UserManagementDeleteController",size:"md",resolve:{entity:["User",function(e){return e.get({id:n.id})}]}}).result.then(function(e){t.go("user-management",null,{reload:!0})},function(){t.go("^")})}]}).state("user-management.invite",{parent:"user-management",url:"/invite",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal",function(t,e){e.open({templateUrl:"scripts/app/uaa/user-management/user-management-invite.html",controller:"UserManagementInviteController",size:"lg"}).result.then(function(e){t.go("user-management",null,{reload:!0})},function(){t.go("user-management")})}]})}]),angular.module("uaaUIApp").config(["$stateProvider",function(e){e.state("group-management",{parent:"uaa",url:"/group-management?search",params:{search:""},data:{authorities:["ROLE_ADMIN"],pageTitle:"GroupManagement@UaaUI"},views:{"content@":{templateUrl:"scripts/app/uaa/group-management/group-management.html",controller:"GroupManagementController"}},resolve:{}}).state("group-management-detail",{parent:"uaa",url:"/group/:id",data:{authorities:["ROLE_ADMIN"],pageTitle:"GroupManagementDetail@UaaUI"},views:{"content@":{templateUrl:"scripts/app/uaa/group-management/group-management-detail.html",controller:"GroupManagementDetailController"}},resolve:{}}).state("group-management.new",{parent:"group-management",url:"/new",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal",function(t,e){e.open({templateUrl:"scripts/app/uaa/group-management/group-management-edit.html",controller:"GroupManagementEditController",size:"lg",resolve:{entity:["Group",function(e){return new e}]}}).result.then(function(e){t.go("group-management",null,{reload:!0})},function(){t.go("group-management")})}]}).state("group-management.edit",{parent:"group-management",url:"/{id}/edit",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal","$stateParams",function(t,e,n){e.open({templateUrl:"scripts/app/uaa/group-management/group-management-edit.html",controller:"GroupManagementEditController",size:"lg",resolve:{entity:["Group",function(e){return e.get({id:n.id})}]}}).result.then(function(e){t.go("group-management",null,{reload:!0})},function(){t.go("^")})}]}).state("group-management.delete",{parent:"group-management",url:"/{id}/delete",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal","$stateParams",function(t,e,n){e.open({templateUrl:"scripts/app/uaa/group-management/group-management-delete.html",controller:"GroupManagementDeleteController",size:"md",resolve:{entity:["Group",function(e){return e.get({id:n.id})}]}}).result.then(function(e){t.go("group-management",null,{reload:!0})},function(){t.go("^")})}]})}]),angular.module("uaaUIApp").controller("GroupManagementController",["$scope","$stateParams","Group","Search",function(a,e,o,t){a.groups=[],a.pageTotal=0,a.pageNumber=1,a.pageSize=5,a.loadPage=function(e,t,n){var r=(a.pageNumber-1)*a.pageSize+1;o.query({startIndex:r,count:a.pageSize,filter:e,sortBy:t,sortOrder:n},function(e){a.pageTotal=e.totalResults,a.groups=e.resources})},a.clear=function(){a.group={},a.editForm.$setPristine(),a.editForm.$setUntouched()},a.selected={value:[]},a.filters=t.init(a.loadPage,a.selected,[{name:"ID",field:"id",moment:!1,sort:!1,any:!0},{name:"DisplayName",field:"displayName",moment:!1,sort:!0,any:!0},{name:"Description",field:"description",moment:!1,sort:!1,any:!0},{name:"Created",field:"created",moment:!0,sort:!0},{name:"LastModified",field:"lastModified",moment:!0,sort:!0}]),a.tagging=t.tagging,a.filtering=t.filtering,a.pagging=t.refreshing,t.searching(e.search)}]),angular.module("uaaUIApp").controller("GroupManagementDetailController",["$scope","$stateParams","Group",function(t,e,n){t.group={},t.load=function(e){n.get({id:e},function(e){t.group=e})},t.load(e.id)}]),angular.module("uaaUIApp").controller("GroupManagementEditController",["$scope","$q","$uibModalInstance","entity","Group",function(n,r,t,e,a){n.group=e;var o=function(e){n.isSaving=!1,t.close(e)},i=function(e){n.isSaving=!1};n.save=function(){n.isSaving=!0,null!=n.group.id?a.update({id:n.group.id},n.group,o,i):a.save(n.group,o,i)},n.clear=function(){t.dismiss("cancel")};!function(){var e;if(angular.isUndefined(n.group.$promise)){var t=r.defer();t.resolve(n.group),e=t.promise}else e=n.group.$promise;e.then(function(e){})}()}]),angular.module("uaaUIApp").controller("GroupManagementDeleteController",["$scope","$uibModalInstance","entity","Group",function(e,t,n,r){e.group=n,e.clear=function(){t.dismiss("cancel")},e.confirmDelete=function(e){r.delete({id:e},function(){t.close(!0)})}}]),angular.module("uaaUIApp").config(["$stateProvider",function(e){e.state("member-management",{parent:"uaa",url:"/{gid}/member-management",data:{authorities:["ROLE_ADMIN"],pageTitle:"MemberManagement@UaaUI"},views:{"content@":{templateUrl:"scripts/app/uaa/member-management/member-management.html",controller:"MemberManagementController"}},resolve:{group:["$stateParams","Group",function(e,t){return t.get({id:e.gid})}]}}).state("member-management.add",{parent:"member-management",url:"/new",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal",function(n,e){e.open({templateUrl:"scripts/app/uaa/member-management/member-management-add.html",controller:"MemberManagementAddController",size:"lg",resolve:{paths:function(){return angular.isUndefined(n.current.data)&&n.go("member-management",null,{reload:!0}),n.current.data.paths}}}).result.then(function(e){var t=0<e.length;t&&(n.reflash(e),t=!1),n.go("member-management",null,{reload:t})},function(){n.go("member-management")})}]}).state("member-management.delete",{parent:"member-management",url:"/delete",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal",function(n,e){e.open({templateUrl:"scripts/app/uaa/member-management/member-management-delete.html",controller:"MemberManagementDeleteController",size:"md",resolve:{paths:function(){return n.current.data.paths}}}).result.then(function(e){var t=0<e.length;t&&(n.reflash(e),t=!1),n.go("member-management",null,{reload:t})},function(){n.go("^")})}]})}]),angular.module("uaaUIApp").controller("MemberManagementController",["$scope","$state","$q","$filter","group","MemberType","Group","User","Member",function(r,a,e,o,t,i,n,s,l){r.paths=[],r.members=[],t.$promise.then(function(e){var t={type:"GROUP",entity:e,value:e.id,id:e.id,members:r.members};i.getName(t).then(function(e){t.name=e}),r.selectItem(t).then(function(e){r.members=e})}),r.clear=function(){r.editForm.$setPristine(),r.editForm.$setUntouched()},r.selectItem=function(t,e){if(e&&e.stopPropagation(),"GROUP"===t.type){var n=[];return u(n,t),r.paths=n,a.current.data.paths=r.paths,c(t).then(function(e){return 0===e.length?t.nochild=!0:(delete t.nochild,t.show=!0),e})}},r.expandItem=function(t,e){e&&e.stopPropagation(),null!==t.members||t.show?0===t.members.length||(t.show=!t.show):c(t).then(function(e){0===e.length?t.nochild=!0:(delete t.nochild,t.show=!0)})};var u=function(e,t){e.unshift(t),void 0!==t.father&&u(e,t.father)},c=function(a){var t=e.defer(),n=function(e){var r=[];return angular.forEach(e,function(e){var t={id:e.value,type:e.type,name:""};i.getName(e).then(function(e){t.name=e});var n=o("filter")(a.members,{id:t.id});null!=n&&1===n.length&&void 0!==n[0]?(t.members=n[0].members,t.show=n[0].show):(t.members=null,t.show=!1),t.father=a,r.push(t)}),r};return l.list({gid:a.id,returnEntities:!0}).$promise.then(n).then(function(e){a.members=e,t.resolve(e)}).catch(function(e){404===e.status?l.list({gid:a.id,returnEntities:!1}).$promise.then(n).then(function(e){a.members=e,t.resolve(e)}):t.reject(e)}),t.promise};a.reflash=function(e){var t=r.paths.slice(-1)[0];r.selectItem(t).then(function(e){1===r.paths.length&&(r.members=e)})}}]),angular.module("uaaUIApp").controller("MemberManagementAddController",["$scope","$q","$filter","$uibModalInstance","paths","Group","User","Member","AlertService",function(a,o,r,t,e,i,s,l,n){a.paths=e,a.actionItems=[],a.searchUserItems=[],a.searchGroupItems=[],a.searchMode={user:!0,group:!0},a.searchText="",a.pageTotal=0,a.pageSize=10,a.pageNumber=1,a.changePath=function(e,t){a.paths=a.paths.slice(0,e+1)},a.addAction=function(e){-1==a.actionItems.indexOf(e)?a.actionItems.push(e):n.warning("Already added!")},a.removeAction=function(e){a.actionItems.splice(e,1)},a.loadPage=function(r){a.searchUserItems=[],a.searchGroupItems=[];var e,t=(a.pageNumber-1)*a.pageSize+1,n=[];a.searchMode.user&&(e="userName co '"+a.searchText+"'",n.push(s.query({startIndex:t,count:a.pageSize,filter:e}).$promise)),a.searchMode.group&&(e="displayName co '"+a.searchText+"'",n.push(i.query({startIndex:t,count:a.pageSize,filter:e}).$promise)),o.all(n).then(function(e){var t=e[0],n=e[1];r||(a.pageTotal=Math.max(t.totalResults,n.totalResults)),angular.forEach(t.resources,function(e){a.searchUserItems.push({name:e.userName,id:e.id,type:"USER"})}),angular.forEach(n.resources,function(e){a.searchGroupItems.push({name:e.displayName,id:e.id,type:"GROUP"})})})};var u=function(e){a.isSaving=!1,t.close(e)},c=function(e){a.isSaving=!1};a.save=function(){a.isSaving=!0;var t=a.paths.slice(-1)[0],n=[];angular.forEach(a.actionItems,function(e){n.push(l.add({gid:t.id},{origin:"uaa",type:e.type,value:e.id},function(e){var t=r("filter")(a.actionItems,{id:e.value});if(1===t.length){var n=a.actionItems.indexOf(t[0]);a.actionItems.splice(n,1)}}).$promise)}),o.all(n).then(u).catch(c)},a.clear=function(){t.dismiss("cancel")}}]),angular.module("uaaUIApp").controller("MemberManagementDeleteController",["$scope","$q","$filter","$uibModalInstance","paths","MemberType","Member","AlertService",function(o,i,r,t,e,s,l,n){o.paths=e,o.actionItems=[],o.members=[],o.changePath=function(e,t){if(e+1!==o.paths.length){e+1>o.paths.length&&(e=o.paths.length-1),o.paths=o.paths.slice(0,e+1);var n=o.paths[e],r=i.defer(),a=function(e){var n=[];return angular.forEach(e,function(e){var t={id:e.value,type:e.type,name:""};s.getName(e).then(function(e){t.name=e}),n.push(t)}),n};return l.list({gid:n.id,returnEntities:!0}).$promise.then(a).then(function(e){o.members=e,r.resolve(e)}).catch(function(e){404===e.status?l.list({gid:n.id,returnEntities:!1}).$promise.then(a).then(function(e){o.members=e,r.resolve(e)}):r.reject(e)}),r.promise}},o.addAction=function(e){-1==o.actionItems.indexOf(e)?o.actionItems.push(e):n.warning("Already added!")},o.removeAction=function(e){o.actionItems.splice(e,1)};var a=function(e){o.isSaving=!1,t.close(e)},u=function(e){o.isSaving=!1};o.changePath(o.paths.length),o.save=function(){o.isSaving=!0;var t=o.paths.slice(-1)[0],n=[];angular.forEach(o.actionItems,function(e){n.push(l.remove({gid:t.id,id:e.id},function(e){var t=r("filter")(o.actionItems,{id:e.value});if(null!=t&&1===t.length){var n=o.actionItems.indexOf(t[0]);o.actionItems.splice(n,1)}}).$promise)}),i.all(n).then(a).catch(u)},o.clear=function(){t.dismiss("cancel")}}]),angular.module("uaaUIApp").config(["$stateProvider",function(e){e.state("token-client",{parent:"client-management-detail",params:{type:"client"},data:{previous:!1},views:{token:{templateUrl:"scripts/app/uaa/token-management/token-management.html",controller:"TokenManagementController"}}}).state("token-user",{parent:"user-management-detail",params:{type:"user"},data:{previous:!1},views:{token:{templateUrl:"scripts/app/uaa/token-management/token-management.html",controller:"TokenManagementController"}}})}]),angular.module("uaaUIApp").controller("TokenManagementController",["$scope","$stateParams","$state","$filter","Token","Group","TokenHolder","ZoneHolder","Principal","AlertService",function(n,e,a,o,t,i,r,s,l,u){n.init=function(t,e){n.id=t,"user"===(n.type=e)?l.identity().then(function(e){n.isMe=e.user_id===t}).catch(function(){n.isMe=!1}):"client"===e&&(n.isMe=r.getJwt().payload.client_id===t),n.loadToken(),s.current().then(function(e){n.zoneId=e.id,n.tokenPolicy=e.config.tokenPolicy})},n.tokens=[],n.loadToken=function(){"user"===n.type?t.userList({id:n.id},function(e){n.tokens=e,angular.forEach(e,function(e){e.scope=e.scope.replace(/\[|\]/g,"").split(", ")})}):"client"===n.type&&t.clientList({id:n.id},function(e){n.tokens=e,angular.forEach(e,function(e){e.scope=e.scope.replace(/\[|\]/g,"").split(", ")})})},n.revokeToken=function(e){e?t.revoke({id:e},function(){if(u.success("<strong>UI: </strong>Revoke token success!"),n.isMe)return r.remove(),l.authenticate(void 0),void a.go("home",null,{reload:!0});n.loadToken()}):"user"===n.type?t.userRevoke({id:n.id},function(e){n.tokens=e}):"client"===n.type&&t.clientRevoke({id:n.id},function(e){n.tokens=e})},n.init(e.id,e.type),n.goGroupListOrDetail=function(n){var r=!1,e="eq";-1!==n.indexOf("*")&&(r=!0,e="co",n=n.replace("*","")),i.query({filter:"displayname "+e+" '"+n+"'"},function(e){var t=o("filter")(e.resources,{displayName:n},!r);1===t.length?a.go("group-management-detail",{id:t[0].id}):1<t.length?a.go("group-management",{search:n}):u.warning("<strong>UI: </strong>"+n+" is not Group!",{timeout:1e6})})}}]),angular.module("uaaUIApp").config(["$stateProvider",function(e){e.state("identity-provider",{parent:"uaa",url:"/identity-provider",data:{authorities:["ROLE_ADMIN"],pageTitle:"IdentityProvider@UaaUI"},views:{"content@":{templateUrl:"scripts/app/uaa/identity-provider/identity-provider.html",controller:"IdentityProviderController"}},resolve:{}}).state("identity-provider-detail",{parent:"uaa",url:"/identity-provider/:id/:type",data:{authorities:["ROLE_ADMIN"],pageTitle:"IdentityProviderDetail@UaaUI"},views:{"content@":{templateUrl:"scripts/app/uaa/identity-provider/identity-provider-detail.html",controller:"IdentityProviderDetailController"}},resolve:{}}).state("identity-provider.new",{parent:"identity-provider",url:"/new",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal",function(t,e){e.open({templateUrl:"scripts/app/uaa/identity-provider/identity-provider-edit.html",controller:"IdentityProviderEditController",size:"lg",resolve:{entity:["IdentityProvider",function(e){return new e({type:"uaa"})}]}}).result.then(function(e){t.go("identity-provider",null,{reload:!0})},function(){t.go("identity-provider")})}]}).state("identity-provider.edit",{parent:"identity-provider",url:"/{id}/edit",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal","$stateParams",function(t,e,n){e.open({templateUrl:"scripts/app/uaa/identity-provider/identity-provider-edit.html",controller:"IdentityProviderEditController",size:"lg",resolve:{entity:["IdentityProvider",function(e){return e.get({id:n.id,rawConfig:!0})}]}}).result.then(function(e){t.go("identity-provider",null,{reload:!0})},function(){t.go("^")})}]}).state("identity-provider.delete",{parent:"identity-provider",url:"/{id}/delete",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal","$stateParams",function(t,e,n){e.open({templateUrl:"scripts/app/uaa/identity-provider/identity-provider-delete.html",controller:"IdentityProviderDeleteController",size:"md",resolve:{entity:["IdentityProvider",function(e){return e.get({id:n.id})}]}}).result.then(function(e){t.go("identity-provider",null,{reload:!0})},function(){t.go("^")})}]}).state("identity-provider-detail.uaa",{parent:"identity-provider-detail",views:{config:{templateUrl:"scripts/app/uaa/identity-provider/config-uaa-detail.html"}}}).state("identity-provider-detail.keystone",{parent:"identity-provider-detail",views:{config:{templateUrl:"scripts/app/uaa/identity-provider/config-keystone-detail.html"}}}).state("identity-provider-detail.oidc10",{parent:"identity-provider-detail",views:{config:{templateUrl:"scripts/app/uaa/identity-provider/config-oidc-detail.html"}}}).state("identity-provider-detail.oauth20",{parent:"identity-provider-detail",views:{config:{templateUrl:"scripts/app/uaa/identity-provider/config-oauth2-detail.html"}}}).state("identity-provider-detail.ldap",{parent:"identity-provider-detail",views:{config:{templateUrl:"scripts/app/uaa/identity-provider/config-ldap-detail.html"}}}).state("identity-provider-detail.saml",{parent:"identity-provider-detail",views:{config:{templateUrl:"scripts/app/uaa/identity-provider/config-saml-detail.html"}}}).state("identity-provider.edit.uaa",{parent:"identity-provider.edit",views:{"config@":{templateUrl:"scripts/app/uaa/identity-provider/config-uaa-edit.html"}}}).state("identity-provider.edit.keystone",{parent:"identity-provider.edit",views:{"config@":{templateUrl:"scripts/app/uaa/identity-provider/config-keystone-edit.html"}}}).state("identity-provider.edit.oidc10",{parent:"identity-provider.edit",views:{"config@":{templateUrl:"scripts/app/uaa/identity-provider/config-oidc-edit.html"}}}).state("identity-provider.edit.oauth20",{parent:"identity-provider.edit",views:{"config@":{templateUrl:"scripts/app/uaa/identity-provider/config-oauth2-edit.html"}}}).state("identity-provider.edit.ldap",{parent:"identity-provider.edit",views:{"config@":{templateUrl:"scripts/app/uaa/identity-provider/config-ldap-edit.html"}}}).state("identity-provider.edit.saml",{parent:"identity-provider.edit",views:{"config@":{templateUrl:"scripts/app/uaa/identity-provider/config-saml-edit.html"}}}).state("identity-provider.new.uaa",{parent:"identity-provider.new",views:{"config@":{templateUrl:"scripts/app/uaa/identity-provider/config-uaa-edit.html"}}}).state("identity-provider.new.keystone",{parent:"identity-provider.new",views:{"config@":{templateUrl:"scripts/app/uaa/identity-provider/config-keystone-edit.html"}}}).state("identity-provider.new.oidc10",{parent:"identity-provider.new",views:{"config@":{templateUrl:"scripts/app/uaa/identity-provider/config-oidc-edit.html"}}}).state("identity-provider.new.oauth20",{parent:"identity-provider.new",views:{"config@":{templateUrl:"scripts/app/uaa/identity-provider/config-oauth2-edit.html"}}}).state("identity-provider.new.ldap",{parent:"identity-provider.new",views:{"config@":{templateUrl:"scripts/app/uaa/identity-provider/config-ldap-edit.html"}}}).state("identity-provider.new.saml",{parent:"identity-provider.new",views:{"config@":{templateUrl:"scripts/app/uaa/identity-provider/config-saml-edit.html"}}})}]),angular.module("uaaUIApp").controller("IdentityProviderController",["$scope","IdentityProvider",function(t,e){t.providers=[],t.loadAll=function(){e.query({},function(e){t.providers=e})},t.loadAll(),t.clear=function(){t.provider={},t.editForm.$setPristine(),t.editForm.$setUntouched()}}]),angular.module("uaaUIApp").controller("IdentityProviderDetailController",["$scope","$state","$stateParams","IdentityProvider",function(t,e,n,r){t.types=["uaa","oauth2.0","oidc1.0","keystone","saml","ldap"],t.isUnknowType=function(e){return-1===t.types.indexOf(e)},t.isUnknowType(n.type)||-1!==e.current.name.indexOf(n.type)||e.go("identity-provider-detail."+n.type.replace(".","")),t.provider={},t.load=function(e){r.get({id:e,rawConfig:!0},function(e){"saml"===(t.provider=e).type&&(0==e.config.metaDataLocation.indexOf("<?xml")||0==e.config.metaDataLocation.indexOf("<md:EntityDescriptor")||0==e.config.metaDataLocation.indexOf("<EntityDescriptor")?t.ui.MetaDataFormat="XML":0==e.config.metaDataLocation.indexOf("http")&&(t.ui.MetaDataFormat="URL"))})},t.load(n.id),t.ui={MetaDataFormat:"URL"}}]),angular.module("uaaUIApp").controller("IdentityProviderEditController",["$scope","$q","$http","$uibModalInstance","$state","entity","IdentityProvider","Setting","SetUtils",function(n,r,e,t,a,o,i,s,l){n.setting=s.get(),n.provider=o,n.baseState=a.current.name;var u=function(e){n.isSaving=!1,t.close(e)},c=function(e){n.isSaving=!1};n.save=function(){n.isSaving=!0,null!=n.provider.id?i.update({id:n.provider.id},n.provider,u,c):i.save(n.provider,u,c)},n.clear=function(){t.dismiss("cancel")},n.types=["uaa","oauth2.0","oidc1.0","keystone","ldap","saml"],n.isUnknowType=function(e){return-1===n.types.indexOf(e)};var d={saml:function(e){angular.merge(e,{emailDomain:[],externalGroupsWhitelist:[],attributeMappings:{external_groups:[]},metaDataLocation:"",authnContext:[]},e),0==e.metaDataLocation.indexOf("<?xml")||0==e.metaDataLocation.indexOf("<md:EntityDescriptor")||0==e.metaDataLocation.indexOf("<EntityDescriptor")?n.ui.MetaDataFormat="XML":0==e.metaDataLocation.indexOf("http")&&(n.ui.MetaDataFormat="URL")},ldap:function(e){angular.merge(e,{emailDomain:[],externalGroupsWhitelist:[],attributeMappings:{external_groups:[]}},e)},"oidc1.0":function(e){angular.merge(e,{emailDomain:[],externalGroupsWhitelist:[],attributeMappings:{external_groups:[]},scopes:[],prompts:[],showLinkText:!1},e)},"oauth2.0":function(e){angular.merge(e,{emailDomain:[],externalGroupsWhitelist:[],attributeMappings:{external_groups:[]},scopes:[],showLinkText:!1},e)},uaa:function(e){angular.merge(e,{emailDomain:[]},e)},keystone:function(e){angular.merge(e,{emailDomain:[],externalGroupsWhitelist:[],attributeMappings:{external_groups:[]}},e)}};n.change=function(e){if(angular.isUndefined(n.provider.type))n.active="none";else{n.provider.type!==e?n.provider.config={}:(null===n.provider.config||angular.isUndefined(n.provider.config))&&(n.provider.config={}),n.provider.type=e;var t=d[e];angular.isFunction(t)&&t(n.provider.config),a.go(n.baseState+"."+e.replace(".",""))}},n.addItem=l.addItem,n.deleItem=l.deleItem,n.hasItem=l.hasItem,n.toggleItem=l.toggleItem,n.ui={MetaDataFormat:"URL"},n.import={url:n.setting.url+".well-known/openid-configuration"},n.importConfig=function(){e.get(n.import.url,{},{headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"}}).then(function(e){var t=n.provider.config;t.issuer=e.data.issuer,t.authUrl=e.data.authorization_endpoint,t.tokenUrl=e.data.token_endpoint,t.userInfoUrl=e.data.userinfo_endpoint,t.tokenKeyUrl=e.data.jwks_uri,t.scopes=e.data.scopes_supported})};!function(){var e;if(angular.isUndefined(n.provider.$promise)){var t=r.defer();t.resolve(n.provider),e=t.promise}else e=n.provider.$promise;e.then(function(e){n.active=e.type})}()}]),angular.module("uaaUIApp").controller("IdentityProviderDeleteController",["$scope","$uibModalInstance","entity","IdentityProvider",function(e,t,n,r){e.provider=n,e.clear=function(){t.dismiss("cancel")},e.confirmDelete=function(e){r.delete({id:e},function(){t.close(!0)})}}]),angular.module("uaaUIApp").config(["$stateProvider",function(e){e.state("mfa-provider",{parent:"uaa",url:"/mfa-provider",data:{authorities:["ROLE_ADMIN"],pageTitle:"MFAProvider@UaaUI"},views:{"content@":{templateUrl:"scripts/app/uaa/mfa-provider/mfa-provider.html",controller:"MFAProviderController"}},resolve:{}}).state("mfa-provider-detail",{parent:"uaa",url:"/mfa-provider/:id/:type",data:{authorities:["ROLE_ADMIN"],pageTitle:"MFAProviderDetail@UaaUI"},views:{"content@":{templateUrl:"scripts/app/uaa/mfa-provider/mfa-provider-detail.html",controller:"MFAProviderDetailController"}},resolve:{}}).state("mfa-provider.new",{parent:"mfa-provider",url:"/new",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal",function(t,e){e.open({templateUrl:"scripts/app/uaa/mfa-provider/mfa-provider-edit.html",controller:"MFAProviderEditController",size:"lg",resolve:{entity:["MFAProvider",function(e){return new e}]}}).result.then(function(e){t.go("mfa-provider",null,{reload:!0})},function(){t.go("mfa-provider")})}]}).state("mfa-provider.delete",{parent:"mfa-provider",url:"/{id}/delete",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal","$stateParams",function(t,e,n){e.open({templateUrl:"scripts/app/uaa/mfa-provider/mfa-provider-delete.html",controller:"MFAProviderDeleteController",size:"md",resolve:{entity:["MFAProvider",function(e){return e.get({id:n.id})}]}}).result.then(function(e){t.go("mfa-provider",null,{reload:!0})},function(){t.go("^")})}]})}]),angular.module("uaaUIApp").controller("MFAProviderController",["$scope","MFAProvider",function(t,e){t.providers=[],t.loadAll=function(){e.query({},function(e){t.providers=e})},t.loadAll(),t.clear=function(){t.provider={},t.editForm.$setPristine(),t.editForm.$setUntouched()}}]),angular.module("uaaUIApp").controller("MFAProviderEditController",["$scope","$q","$uibModalInstance","entity","MFAProvider",function(n,r,t,e,a){n.provider=e;var o=function(e){n.isSaving=!1,t.close(e)},i=function(e){n.isSaving=!1};n.save=function(){n.isSaving=!0,null!=n.provider.id?a.update({id:n.provider.id},n.provider,o,i):a.save(n.provider,o,i)},n.clear=function(){t.dismiss("cancel")};!function(){var e;if(angular.isUndefined(n.provider.$promise)){var t=r.defer();t.resolve(n.provider),e=t.promise}else e=n.provider.$promise;e.then(function(e){angular.isUndefined(e.type)&&(e.type="google-authenticator")})}()}]),angular.module("uaaUIApp").controller("MFAProviderDetailController",["$scope","$state","$stateParams","$location","$filter","MFAProvider","Setting",function(t,e,n,r,a,o,i){t.provider={},t.load=function(e){o.get({id:e},function(e){t.provider=e})},t.load(n.id)}]),angular.module("uaaUIApp").controller("MFAProviderDeleteController",["$scope","$uibModalInstance","entity","MFAProvider",function(e,t,n,r){e.provider=n,e.clear=function(){t.dismiss("cancel")},e.confirmDelete=function(e){r.delete({id:e},function(){t.close(!0)})}}]),angular.module("uaaUIApp").config(["$stateProvider",function(e){e.state("saml-service-provider",{parent:"uaa",url:"/saml-service-provider",data:{authorities:["ROLE_ADMIN"],pageTitle:"SAMLServiceProvider@UaaUI"},views:{"content@":{templateUrl:"scripts/app/uaa/saml-service-provider/saml-service-provider.html",controller:"SAMLServiceProviderController"}},resolve:{}}).state("saml-service-provider-detail",{parent:"uaa",url:"/saml-service-provider/:id/:type",data:{authorities:["ROLE_ADMIN"],pageTitle:"SAMLServiceProviderDetail@UaaUI"},views:{"content@":{templateUrl:"scripts/app/uaa/saml-service-provider/saml-service-provider-detail.html",controller:"SAMLServiceProviderDetailController"}},resolve:{}}).state("saml-service-provider.new",{parent:"saml-service-provider",url:"/new",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal",function(t,e){e.open({templateUrl:"scripts/app/uaa/saml-service-provider/saml-service-provider-edit.html",controller:"SAMLServiceProviderEditController",size:"lg",resolve:{entity:["SAMLServiceProvider",function(e){return new e}]}}).result.then(function(e){t.go("saml-service-provider",null,{reload:!0})},function(){t.go("saml-service-provider")})}]}).state("saml-service-provider.edit",{parent:"saml-service-provider",url:"/{id}/edit",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal","$stateParams",function(t,e,n){e.open({templateUrl:"scripts/app/uaa/saml-service-provider/saml-service-provider-edit.html",controller:"SAMLServiceProviderEditController",size:"lg",resolve:{entity:["SAMLServiceProvider",function(e){return e.get({id:n.id})}]}}).result.then(function(e){t.go("saml-service-provider",null,{reload:!0})},function(){t.go("^")})}]}).state("saml-service-provider.delete",{parent:"saml-service-provider",url:"/{id}/delete",data:{authorities:["ROLE_ADMIN"]},onEnter:["$state","$uibModal","$stateParams",function(t,e,n){e.open({templateUrl:"scripts/app/uaa/saml-service-provider/saml-service-provider-delete.html",controller:"SAMLServiceProviderDeleteController",size:"md",resolve:{entity:["SAMLServiceProvider",function(e){return e.get({id:n.id})}]}}).result.then(function(e){t.go("saml-service-provider",null,{reload:!0})},function(){t.go("^")})}]})}]),angular.module("uaaUIApp").controller("SAMLServiceProviderController",["$scope","clipboard","SAMLServiceProvider",function(t,n,e){t.providers=[],t.loadAll=function(){e.query({},function(e){t.providers=e,angular.forEach(e,function(e){e.ui={},0==e.config.metaDataLocation.indexOf("<?xml")||0==e.config.metaDataLocation.indexOf("<md:EntityDescriptor")||0==e.config.metaDataLocation.indexOf("<EntityDescriptor")?e.ui.MetaDataFormat="XML":0==e.config.metaDataLocation.indexOf("http")&&(e.ui.MetaDataFormat="URL")})})},t.loadAll(),t.clear=function(){t.provider={},t.editForm.$setPristine(),t.editForm.$setUntouched()},t.copy=function(e){n.copyText(e)}}]),angular.module("uaaUIApp").controller("SAMLServiceProviderEditController",["$scope","$q","$uibModalInstance","entity","SAMLServiceProvider",function(n,r,t,e,a){n.provider=e;var o=function(e){n.isSaving=!1,t.close(e)},i=function(e){n.isSaving=!1};n.save=function(){n.isSaving=!0,n.provider.config.staticCustomAttributes=angular.fromJson(n.config_staticCustomAttributes),null!=n.provider.id?a.update({id:n.provider.id},n.provider,o,i):a.save(n.provider,o,i)},n.clear=function(){t.dismiss("cancel")},n.ui={MetaDataFormat:"URL"};!function(){var e;if(angular.isUndefined(n.provider.$promise)){var t=r.defer();t.resolve(n.provider),e=t.promise}else e=n.provider.$promise;e.then(function(e){angular.isUndefined(e.active)&&(e.active=!0),n.config_staticCustomAttributes=angular.toJson(e.config.staticCustomAttributes,!0),0==e.config.metaDataLocation.indexOf("<?xml")||0==e.config.metaDataLocation.indexOf("<md:EntityDescriptor")||0==e.config.metaDataLocation.indexOf("<EntityDescriptor")?n.ui.MetaDataFormat="XML":0==e.config.metaDataLocation.indexOf("http")&&(n.ui.MetaDataFormat="URL")})}()}]),angular.module("uaaUIApp").controller("SAMLServiceProviderDetailController",["$scope","$state","$stateParams","$location","$filter","SAMLServiceProvider","Setting",function(t,e,n,r,a,o,i){t.provider={},t.load=function(e){o.get({id:e},function(e){0==(t.provider=e).config.metaDataLocation.indexOf("<?xml")||0==e.config.metaDataLocation.indexOf("<md:EntityDescriptor")||0==e.config.metaDataLocation.indexOf("<EntityDescriptor")?t.ui.MetaDataFormat="XML":0==e.config.metaDataLocation.indexOf("http")&&(t.ui.MetaDataFormat="URL")})},t.load(n.id),t.ui={MetaDataFormat:"URL"}}]),angular.module("uaaUIApp").controller("SAMLServiceProviderDeleteController",["$scope","$uibModalInstance","entity","SAMLServiceProvider",function(e,t,n,r){e.provider=n,e.clear=function(){t.dismiss("cancel")},e.confirmDelete=function(e){r.delete({id:e},function(){t.close(!0)})}}]),angular.module("uaaUIApp").config(["$stateProvider",function(e){e.state("home",{parent:"site",url:"/",data:{authorities:[]},views:{"content@":{templateUrl:"scripts/app/main/main.html",controller:"MainController"}},resolve:{}})}]),angular.module("uaaUIApp").controller("MainController",["$scope","$state","$sce","Setting","UAAServerProvider","Principal","ZoneHolder",function(t,e,n,r,a,o,i){t.error=null,t.errorMessage="",t.setting=r.get(),e.current.name!==t.setting.loginType&&e.go(t.setting.loginType),t.url_healthz=n.trustAsResourceUrl(t.setting.url+"healthz"),t.isHealthy=a.isHealthy,t.isAuthenticated=o.isAuthenticated,t.isClient=o.isClient,t.isZoneMode=!i.isUAA(),t.isSwitchingZone=o.isSwitchingZone,t.exitZoneMode=function(){i.reset(),e.go("home",null,{reload:!0})},i.current().then(function(e){t.zone=e,t.isSwitchingZone()||a.info(!0)}),o.userName().then(function(e){t.userName=e})}]),angular.module("uaaUIApp").config(["$stateProvider",function(e){e.state("uaa",{abstract:!0,parent:"site"})}]);
//# sourceMappingURL=app.js.map
